
```yml dbt_project.yml
on-run-end:
  - "{{ print_results(results) }}"
```


```sql print_results.sql
{% macro print_results(results_object) %}
    {%- do log(results_object, True) -%}
{% endmacro %}
```

```json manifest.json
{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/manifest/v6.json", "dbt_version": "1.2.1", "generated_at": "2022-08-31T15:52:26.492238Z", "invocation_id": "a55b4cb7-a1f2-4fae-9aab-e7af487d9948", "env": {}, "project_id": "5ee5e4bdd1a4b169633d4d57b2464209", "user_id": "9b973392-3191-428f-b811-8608e9e8177a", "send_anonymous_usage_stats": true, "adapter_type": "redshift"}, "nodes": {"model.elementary_integration_tests.dimension_anomalies": {"raw_sql": "-- depends_on: {{ ref('dimension_anomalies_validation') }}\n\nwith training as (\n    select * from {{ ref('dimension_anomalies_training') }}\n),\n\n{% if elementary.table_exists_in_target('dimension_anomalies_validation') %}\n validation as (\n     select * from {{ ref('dimension_anomalies_validation') }}\n ),\n\n source as (\n     select * from training\n     union all\n     select * from validation\n ),\n{% else %}\n source as (\n     select * from training\n ),\n{% endif %}\n\n final as (\n     select\n         date as updated_at,\n         platform,\n         version,\n         user_id\n     from source\n )\n\nselect * from final", "resource_type": "model", "depends_on": {"macros": ["macro.elementary.table_exists_in_target"], "nodes": ["seed.elementary_integration_tests.dimension_anomalies_validation", "seed.elementary_integration_tests.dimension_anomalies_training"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "elementary": {"timestamp_column": "updated_at"}, "post-hook": [], "pre-hook": []}, "database": "dev", "schema": "ms_tests", "fqn": ["elementary_integration_tests", "dimension_anomalies"], "unique_id": "model.elementary_integration_tests.dimension_anomalies", "package_name": "elementary_integration_tests", "root_path": "/Users/maayansalom/workspace/dbt-data-reliability/integration_tests", "path": "dimension_anomalies.sql", "original_file_path": "models/dimension_anomalies.sql", "name": "dimension_anomalies", "alias": "dimension_anomalies", "checksum": {"name": "sha256", "checksum": "e7a2df903dd8e1eeae001c5602377efb8ba546b144c27397c217f31ea0df82eb"}, "tags": [], "refs": [["dimension_anomalies_validation"], ["dimension_anomalies_training"]], "sources": [], "metrics": [], "description": "We use this model to test dimension anomalies", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": "elementary_integration_tests://models/schema.yml", "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1661961053.419878}, "model.elementary_integration_tests.no_timestamp_anomalies": {"raw_sql": "-- depends_on: {{ ref('any_type_column_anomalies_validation') }}\n\nwith training as (\n    select * from {{ ref('any_type_column_anomalies_training') }}\n),\n\n{% if elementary.table_exists_in_target('any_type_column_anomalies_validation') %}\n validation as (\n     select * from {{ ref('any_type_column_anomalies_validation') }}\n ),\n\n source as (\n     select * from training\n     union all\n     select * from validation\n ),\n{% else %}\n source as (\n     select * from training\n ),\n{% endif %}\n\n final as (\n     select\n         date as updated_at,\n         null_count_str,\n         null_percent_str,\n         null_count_float,\n         null_percent_float,\n         null_count_int,\n         null_percent_int,\n         null_count_bool,\n         null_percent_bool\n     from source\n )\n\nselect * from final", "resource_type": "model", "depends_on": {"macros": ["macro.elementary.table_exists_in_target"], "nodes": ["seed.elementary_integration_tests.any_type_column_anomalies_validation", "seed.elementary_integration_tests.any_type_column_anomalies_training"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "dev", "schema": "ms_tests", "fqn": ["elementary_integration_tests", "no_timestamp_anomalies"], "unique_id": "model.elementary_integration_tests.no_timestamp_anomalies", "package_name": "elementary_integration_tests", "root_path": "/Users/maayansalom/workspace/dbt-data-reliability/integration_tests", "path": "no_timestamp_anomalies.sql", "original_file_path": "models/no_timestamp_anomalies.sql", "name": "no_timestamp_anomalies", "alias": "no_timestamp_anomalies", "checksum": {"name": "sha256", "checksum": "5f2714e4a720cbd602af54d2a7c30a336d68debd4663e6ad1d0f867f6f1e9fcc"}, "tags": [], "refs": [["any_type_column_anomalies_validation"], ["any_type_column_anomalies_training"]], "sources": [], "metrics": [], "description": "We use this model to test anomalies when there is no timestamp column", "columns": {"null_count_str": {"name": "null_count_str", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "elementary_integration_tests://models/schema.yml", "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1661961053.4178948}, "model.elementary_integration_tests.numeric_column_anomalies": {"raw_sql": "-- depends_on: {{ ref('numeric_column_anomalies_validation') }}\n\nwith training as (\n    select * from {{ ref('numeric_column_anomalies_training') }}\n),\n\n{% if elementary.table_exists_in_target('numeric_column_anomalies_validation') %}\n validation as (\n     select * from {{ ref('numeric_column_anomalies_validation') }}\n ),\n\n source as (\n     select * from training\n     union all\n     select * from validation\n ),\n{% else %}\n source as (\n     select * from training\n ),\n{% endif %}\n\n final as (\n     select\n         date as updated_at,\n         min,\n         max,\n         zero_count,\n         zero_percent,\n         average,\n         standard_deviation,\n         variance\n     from source\n )\n\nselect * from final", "resource_type": "model", "depends_on": {"macros": ["macro.elementary.table_exists_in_target"], "nodes": ["seed.elementary_integration_tests.numeric_column_anomalies_validation", "seed.elementary_integration_tests.numeric_column_anomalies_training"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "elementary": {"timestamp_column": "updated_at"}, "post-hook": [], "pre-hook": []}, "database": "dev", "schema": "ms_tests", "fqn": ["elementary_integration_tests", "numeric_column_anomalies"], "unique_id": "model.elementary_integration_tests.numeric_column_anomalies", "package_name": "elementary_integration_tests", "root_path": "/Users/maayansalom/workspace/dbt-data-reliability/integration_tests", "path": "numeric_column_anomalies.sql", "original_file_path": "models/numeric_column_anomalies.sql", "name": "numeric_column_anomalies", "alias": "numeric_column_anomalies", "checksum": {"name": "sha256", "checksum": "64db5f61545f5bc21fc14199b5f37f2e34f3f7fc98d0c0329ac5373876590f99"}, "tags": [], "refs": [["numeric_column_anomalies_validation"], ["numeric_column_anomalies_training"]], "sources": [], "metrics": [], "description": "", "columns": {"min": {"name": "min", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "max": {"name": "max", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "average": {"name": "average", "description": "", "meta": {}, "data_type": null, 
```

```json run_results.json
{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v4.json", "dbt_version": "1.2.1", "generated_at": "2022-08-31T15:52:57.453540Z", "invocation_id": "a55b4cb7-a1f2-4fae-9aab-e7af487d9948", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2022-08-31T15:52:32.961912Z", "completed_at": "2022-08-31T15:52:35.810773Z"}, {"name": "execute", "started_at": "2022-08-31T15:52:35.811615Z", "completed_at": "2022-08-31T15:52:38.177510Z"}], "thread_id": "Thread-11", "execution_time": 5.424772024154663, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.elementary.filtered_information_schema_tables"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2022-08-31T15:52:32.964068Z", "completed_at": "2022-08-31T15:52:33.104120Z"}, {"name": "execute", "started_at": "2022-08-31T15:52:33.180134Z", "completed_at": "2022-08-31T15:52:38.585135Z"}], "thread_id": "Thread-12", "execution_time": 5.656126022338867, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.elementary.schema_columns_snapshot"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2022-08-31T15:52:32.961686Z", "completed_at": "2022-08-31T15:52:35.801638Z"}, {"name": "execute", "started_at": "2022-08-31T15:52:35.801835Z", "completed_at": "2022-08-31T15:52:38.999618Z"}], "thread_id": "Thread-10", "execution_time": 6.31280779838562, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.elementary.filtered_information_schema_columns"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2022-08-31T15:52:32.951318Z", "completed_at": "2022-08-31T15:52:33.126893Z"}, {"name": "execute", "started_at": "2022-08-31T15:52:33.260820Z", "completed_at": "2022-08-31T15:52:39.451377Z"}], "thread_id": "Thread-1", "execution_time": 6.507683992385864, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.elementary.data_monitoring_metrics"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2022-08-31T15:52:32.956119Z", "completed_at": "2022-08-31T15:52:33.104165Z"}, {"name": "execute", "started_at": "2022-08-31T15:52:33.199317Z", "completed_at": "2022-08-31T15:52:39.533635Z"}], "thread_id": "Thread-9", "execution_time": 6.586272954940796, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.elementary.elementary_test_results"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2022-08-31T15:52:32.952178Z", "completed_at": "2022-08-31T15:52:33.088458Z"}, {"name": "execute", "started_at": "2022-08-31T15:52:33.115153Z", "completed_at": "2022-08-31T15:52:39.782432Z"}], "thread_id": "Thread-3", "execution_time": 6.9991700649261475, "adapter_response": {"_message": "SELECT", "code": "SELECT", "rows_affected": -1}, "message": "SELECT", "failures": null, "unique_id": "model.elementary.dbt_metrics"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2022-08-31T15:52:32.955679Z", "completed_at": "2022-08-31T15:52:33.079957Z"}, {"name": "execute", "started_at": "2022-08-31T15:52:33.104237Z", "completed_at": "2022-08-31T15:52:40.666422Z"}], "thread_id": "Thread-6", "execution_time": 7.875714063644409, "adapter_response": {"_message": "SELECT", "code": "SELECT", "rows_affected": -1}, "message": "SELECT", "failures": null, "unique_id": "model.elementary.dbt_snapshots"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2022-08-31T15:52:32.951812Z", "completed_at": "2022-08-31T15:52:33.086000Z"}, {"name": "execute", "started_at": "2022-08-31T15:52:33.109434Z", "completed_at": "2022-08-31T15:52:41.491403Z"}], "thread_id": "Thread-2", "execution_time": 8.771382093429565, "adapter_response": {"_message": "SELECT", "code": "SELECT", "rows_affected": -1}, "message": "SELECT", "failures": null, "unique_id": "model.elementary.dbt_exposures"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2022-08-31T15:52:32.955819Z", "completed_at": "2022-08-31T15:52:33.098716Z"}, {"name": "execute", "started_at": "2022-08-31T15:52:33.129959Z", "completed_at": "2022-08-31T15:52:42.383696Z"}], "thread_id": "Thread-7", "execution_time": 9.592031002044678, "adapter_response": {"_message": "SELECT", "code": "SELECT", "rows_affected": -1}, "message": "SELECT", "failures": null, "unique_id": "model.elementary.dbt_sources"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2022-08-31T15:52:32.952274Z", "completed_at": "2022-08-31T15:52:33.098784Z"}, {"name": "execute", "started_at": "2022-08-31T15:52:33.136348Z", "completed_at": "2022-08-31T15:52:43.113046Z"}], "thread_id": "Thread-4", "execution_time": 10.46756625175476, "adapter_response": {"_message": "SELECT", "code": "SELECT", "rows_affected": -1}, "message": "SELECT", "failures": null, "unique_id": "model.elementary.dbt_models"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2022-08-31T15:52:32.955986Z", "completed_at": "2022-08-31T15:52:33.095687Z"}, {"name": "execute", "started_at": "2022-08-31T15:52:33.124767Z", "completed_at": "2022-08-31T15:52:43.959433Z"}], "thread_id": "Thread-8", "execution_time": 11.181440114974976, "adapter_response": {"_message": "SELECT", "code": "SELECT", "rows_affected": -1}, "message": "SELECT", "failures": null, "unique_id": "model.elementary.dbt_tests"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2022-08-31T15:52:32.952365Z", "completed_at": "2022-08-31T15:52:33.115072Z"}, {"name": "execute", "started_at": "2022-08-31T15:52:33.221306Z", "completed_at": "2022-08-31T15:52:44.470643Z"}], "thread_id": "Thread-5", "execution_time": 11.52445101737976, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.elementary.dbt_run_results"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2022-08-31T15:52:39.464331Z", "completed_at": "2022-08-31T15:52:39.535842Z"}, {"name": "execute", "started_at": "2022-08-31T15:52:39.552306Z", "completed_at": "2022-08-31T15:52:44.859903Z"}], "thread_id": "Thread-15", "execution_time": 5.586253881454468, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.elementary.monitors_runs"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2022-08-31T15:52:39.464141Z", "completed_at": "2022-08-31T15:52:39.587127Z"}, {"name": "execute", "started_at": "2022-08-31T15:52:39.629955Z", "completed_at": "2022-08-31T15:52:45.672131Z"}], "thread_id": "Thread-14", "execution_time": 6.456078052520752, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.elementary.metrics_anomaly_score"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2022-08-31T15:52:39.567598Z", "completed_at": "2022-08-31T15:52:39.581543Z"}, {"name": "execute", "started_at": "2022-08-31T15:52:39.587326Z", "completed_at": "2022-08-31T15:52:46.567622Z"}], "thread_id": "Thread-13", "execution_time": 7.200356960296631, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.elementary.alerts_anomaly_detection"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2022-08-31T15:52:39.568488Z", "completed_at": "2022-08-31T15:52:39.581775Z"}, {"name": "execute", "started_at": "2022-08-31T15:52:39.626819Z", "completed_at": "2022-08-31T15:52:47.301670Z"}], "thread_id": "Thread-12", "execution_time": 8.053805828094482, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.elementary.alerts_schema_changes"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2022-08-31T15:52:39.568368Z", "completed_at": "2022-08-31T15:52:39.581399Z"}, {"name": "execute", "started_at": "2022-08-31T15:52:39.582022Z", "completed_at": "2022-08-31T15:52:48.200705Z"}], "thread_id": "Thread-11", "execution_time": 8.804276943206787, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.elementary.alerts_dbt_tests"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2022-08-31T15:52:44.496397Z", "completed_at": "2022-08-31T15:52:44.507950Z"}, {"name": "execute", "started_at": "2022-08-31T15:52:44.508625Z", "completed_at": "2022-08-31T15:52:49.047481Z"}], "thread_id": "Thread-16", "execution_time": 4.710334062576294, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.elementary.snapshot_run_results"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2022-08-31T15:52:44.486209Z", "completed_at": "2022-08-31T15:52:44.501324Z"}, {"name": "execute", "started_at": "2022-08-31T15:52:44.501638Z", "completed_at": "2022-08-31T15:52:49.854927Z"}], "thread_id": "Thread-1", "execution_time": 5.523040056228638, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.elementary.model_run_results"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2022-08-31T15:52:45.922407Z", "completed_at": "2022-08-31T15:52:45.933887Z"}, {"name": "execute", "started_at": "2022-08-31T15:52:45.934128Z", "completed_at": "2022-08-31T15:52:50.755901Z"}], "thread_id": "Thread-10", "execution_time": 4.992408275604248, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.elementary.anomaly_threshold_sensitivity"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2022-08-31T15:52:50.017796Z", "completed_at": "2022-08-31T15:52:50.032475Z"}, {"name": "execute", "started_at": "2022-08-31T15:52:50.033105Z", "completed_at": "2022-08-31T15:52:53.243030Z"}], "thread_id": "Thread-6", "execution_time": 3.371133804321289, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.elementary.alerts_dbt_models"}], "elapsed_time": 30.891746997833252, "args": {"write_json": true, "use_colors": true, "printer_width": 80, "version_check": true, "partial_parse": true, "static_parser": true, "profiles_dir": "/Users/maayansalom/.dbt", "send_anonymous_usage_stats": true, "event_buffer_size": 100000, "quiet": false, "no_print": false, "target": "redshift", "select": ["elementary"], "which": "run", "rpc_method": "run", "indirect_selection": "eager"}}
```