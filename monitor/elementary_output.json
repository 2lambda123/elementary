{"creation_time": "2022-06-16 21:15:13", "models": {"model.jaffle_shop_online.orders": {"name": "orders", "unique_id": "model.jaffle_shop_online.orders", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "orders", "owners": ["Or"], "tags": ["finance"], "package_name": "jaffle_shop_online", "description": "This table has basic information about orders, as well as some derived facts based on payments", "full_path": "models/orders.sql", "file_name": "orders.sql", "model_name": "orders", "normalized_full_path": "models/orders.sql"}, "model.jaffle_shop_online.stg_customers": {"name": "stg_customers", "unique_id": "model.jaffle_shop_online.stg_customers", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "stg_customers", "owners": ["Idan"], "tags": ["staging", "PII"], "package_name": "jaffle_shop_online", "description": "", "full_path": "models/staging/stg_customers.sql", "file_name": "stg_customers.sql", "model_name": "stg_customers", "normalized_full_path": "models/staging/stg_customers.sql"}, "model.jaffle_shop_online.stg_payments": {"name": "stg_payments", "unique_id": "model.jaffle_shop_online.stg_payments", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "stg_payments", "owners": ["Idan"], "tags": ["staging", "finance"], "package_name": "jaffle_shop_online", "description": "", "full_path": "models/staging/stg_payments.sql", "file_name": "stg_payments.sql", "model_name": "stg_payments", "normalized_full_path": "models/staging/stg_payments.sql"}, "model.jaffle_shop_online.stg_orders": {"name": "stg_orders", "unique_id": "model.jaffle_shop_online.stg_orders", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "stg_orders", "owners": ["Idan"], "tags": ["staging", "finance"], "package_name": "jaffle_shop_online", "description": "", "full_path": "models/staging/stg_orders.sql", "file_name": "stg_orders.sql", "model_name": "stg_orders", "normalized_full_path": "models/staging/stg_orders.sql"}, "model.elementary.test_run_results": {"name": "test_run_results", "unique_id": "model.elementary.test_run_results", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "test_run_results", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/operational_monitoring/test_run_results.sql", "file_name": "test_run_results.sql", "model_name": "test_run_results", "normalized_full_path": "models/edr/operational_monitoring/test_run_results.sql"}, "model.elementary.model_run_results": {"name": "model_run_results", "unique_id": "model.elementary.model_run_results", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "model_run_results", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/operational_monitoring/model_run_results.sql", "file_name": "model_run_results.sql", "model_name": "model_run_results", "normalized_full_path": "models/edr/operational_monitoring/model_run_results.sql"}, "model.elementary.alerts_dbt_tests": {"name": "alerts_dbt_tests", "unique_id": "model.elementary.alerts_dbt_tests", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "alerts_dbt_tests", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/alerts/alerts_dbt_tests.sql", "file_name": "alerts_dbt_tests.sql", "model_name": "alerts_dbt_tests", "normalized_full_path": "models/edr/alerts/alerts_dbt_tests.sql"}, "model.elementary.alerts_schema_changes": {"name": "alerts_schema_changes", "unique_id": "model.elementary.alerts_schema_changes", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "alerts_schema_changes", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/alerts/alerts_schema_changes.sql", "file_name": "alerts_schema_changes.sql", "model_name": "alerts_schema_changes", "normalized_full_path": "models/edr/alerts/alerts_schema_changes.sql"}, "model.elementary.alerts_data_monitoring": {"name": "alerts_data_monitoring", "unique_id": "model.elementary.alerts_data_monitoring", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "alerts_data_monitoring", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/alerts/alerts_data_monitoring.sql", "file_name": "alerts_data_monitoring.sql", "model_name": "alerts_data_monitoring", "normalized_full_path": "models/edr/alerts/alerts_data_monitoring.sql"}, "model.elementary.monitors_runs": {"name": "monitors_runs", "unique_id": "model.elementary.monitors_runs", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "monitors_runs", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/system/monitors_runs.sql", "file_name": "monitors_runs.sql", "model_name": "monitors_runs", "normalized_full_path": "models/edr/system/monitors_runs.sql"}, "model.elementary.elementary_test_results": {"name": "elementary_test_results", "unique_id": "model.elementary.elementary_test_results", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "elementary_test_results", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/test_results/elementary_test_results.sql", "file_name": "elementary_test_results.sql", "model_name": "elementary_test_results", "normalized_full_path": "models/edr/test_results/elementary_test_results.sql"}, "model.elementary.dbt_tests": {"name": "dbt_tests", "unique_id": "model.elementary.dbt_tests", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "dbt_tests", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/dbt_artifacts/dbt_tests.sql", "file_name": "dbt_tests.sql", "model_name": "dbt_tests", "normalized_full_path": "models/edr/dbt_artifacts/dbt_tests.sql"}, "model.elementary.dbt_models": {"name": "dbt_models", "unique_id": "model.elementary.dbt_models", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "dbt_models", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/dbt_artifacts/dbt_models.sql", "file_name": "dbt_models.sql", "model_name": "dbt_models", "normalized_full_path": "models/edr/dbt_artifacts/dbt_models.sql"}, "model.elementary.dbt_sources": {"name": "dbt_sources", "unique_id": "model.elementary.dbt_sources", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "dbt_sources", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/dbt_artifacts/dbt_sources.sql", "file_name": "dbt_sources.sql", "model_name": "dbt_sources", "normalized_full_path": "models/edr/dbt_artifacts/dbt_sources.sql"}, "model.elementary.dbt_metrics": {"name": "dbt_metrics", "unique_id": "model.elementary.dbt_metrics", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "dbt_metrics", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/dbt_artifacts/dbt_metrics.sql", "file_name": "dbt_metrics.sql", "model_name": "dbt_metrics", "normalized_full_path": "models/edr/dbt_artifacts/dbt_metrics.sql"}, "model.elementary.dbt_run_results": {"name": "dbt_run_results", "unique_id": "model.elementary.dbt_run_results", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "dbt_run_results", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/dbt_artifacts/dbt_run_results.sql", "file_name": "dbt_run_results.sql", "model_name": "dbt_run_results", "normalized_full_path": "models/edr/dbt_artifacts/dbt_run_results.sql"}, "model.elementary.dbt_exposures": {"name": "dbt_exposures", "unique_id": "model.elementary.dbt_exposures", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "dbt_exposures", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/dbt_artifacts/dbt_exposures.sql", "file_name": "dbt_exposures.sql", "model_name": "dbt_exposures", "normalized_full_path": "models/edr/dbt_artifacts/dbt_exposures.sql"}, "model.elementary.metrics_anomaly_score": {"name": "metrics_anomaly_score", "unique_id": "model.elementary.metrics_anomaly_score", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "metrics_anomaly_score", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/data_monitoring/anomaly_detection/metrics_anomaly_score.sql", "file_name": "metrics_anomaly_score.sql", "model_name": "metrics_anomaly_score", "normalized_full_path": "models/edr/data_monitoring/anomaly_detection/metrics_anomaly_score.sql"}, "model.elementary.anomaly_threshold_sensitivity": {"name": "anomaly_threshold_sensitivity", "unique_id": "model.elementary.anomaly_threshold_sensitivity", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "anomaly_threshold_sensitivity", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/data_monitoring/anomaly_detection/anomaly_threshold_sensitivity.sql", "file_name": "anomaly_threshold_sensitivity.sql", "model_name": "anomaly_threshold_sensitivity", "normalized_full_path": "models/edr/data_monitoring/anomaly_detection/anomaly_threshold_sensitivity.sql"}, "model.elementary.schema_columns_snapshot": {"name": "schema_columns_snapshot", "unique_id": "model.elementary.schema_columns_snapshot", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "schema_columns_snapshot", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/data_monitoring/schema_changes/schema_columns_snapshot.sql", "file_name": "schema_columns_snapshot.sql", "model_name": "schema_columns_snapshot", "normalized_full_path": "models/edr/data_monitoring/schema_changes/schema_columns_snapshot.sql"}, "model.elementary.table_changes": {"name": "table_changes", "unique_id": "model.elementary.table_changes", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "table_changes", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/data_monitoring/schema_changes/table_changes.sql", "file_name": "table_changes.sql", "model_name": "table_changes", "normalized_full_path": "models/edr/data_monitoring/schema_changes/table_changes.sql"}, "model.elementary.column_changes": {"name": "column_changes", "unique_id": "model.elementary.column_changes", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "column_changes", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/data_monitoring/schema_changes/column_changes.sql", "file_name": "column_changes.sql", "model_name": "column_changes", "normalized_full_path": "models/edr/data_monitoring/schema_changes/column_changes.sql"}, "model.elementary.schema_tables_snapshot": {"name": "schema_tables_snapshot", "unique_id": "model.elementary.schema_tables_snapshot", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "schema_tables_snapshot", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/data_monitoring/schema_changes/schema_tables_snapshot.sql", "file_name": "schema_tables_snapshot.sql", "model_name": "schema_tables_snapshot", "normalized_full_path": "models/edr/data_monitoring/schema_changes/schema_tables_snapshot.sql"}, "model.elementary.previous_schema_tables": {"name": "previous_schema_tables", "unique_id": "model.elementary.previous_schema_tables", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "previous_schema_tables", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/data_monitoring/schema_changes/previous_and_current_schemas/previous_schema_tables.sql", "file_name": "previous_schema_tables.sql", "model_name": "previous_schema_tables", "normalized_full_path": "models/edr/data_monitoring/schema_changes/previous_and_current_schemas/previous_schema_tables.sql"}, "model.elementary.current_schema_columns": {"name": "current_schema_columns", "unique_id": "model.elementary.current_schema_columns", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "current_schema_columns", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/data_monitoring/schema_changes/previous_and_current_schemas/current_schema_columns.sql", "file_name": "current_schema_columns.sql", "model_name": "current_schema_columns", "normalized_full_path": "models/edr/data_monitoring/schema_changes/previous_and_current_schemas/current_schema_columns.sql"}, "model.elementary.current_schema_tables": {"name": "current_schema_tables", "unique_id": "model.elementary.current_schema_tables", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "current_schema_tables", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/data_monitoring/schema_changes/previous_and_current_schemas/current_schema_tables.sql", "file_name": "current_schema_tables.sql", "model_name": "current_schema_tables", "normalized_full_path": "models/edr/data_monitoring/schema_changes/previous_and_current_schemas/current_schema_tables.sql"}, "model.elementary.previous_schema_columns": {"name": "previous_schema_columns", "unique_id": "model.elementary.previous_schema_columns", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "previous_schema_columns", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/data_monitoring/schema_changes/previous_and_current_schemas/previous_schema_columns.sql", "file_name": "previous_schema_columns.sql", "model_name": "previous_schema_columns", "normalized_full_path": "models/edr/data_monitoring/schema_changes/previous_and_current_schemas/previous_schema_columns.sql"}, "model.elementary.data_monitoring_metrics": {"name": "data_monitoring_metrics", "unique_id": "model.elementary.data_monitoring_metrics", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "data_monitoring_metrics", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/data_monitoring/data_monitoring/data_monitoring_metrics.sql", "file_name": "data_monitoring_metrics.sql", "model_name": "data_monitoring_metrics", "normalized_full_path": "models/edr/data_monitoring/data_monitoring/data_monitoring_metrics.sql"}, "model.elementary.filtered_information_schema_columns": {"name": "filtered_information_schema_columns", "unique_id": "model.elementary.filtered_information_schema_columns", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "filtered_information_schema_columns", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/metadata_store/filtered_information_schema_columns.sql", "file_name": "filtered_information_schema_columns.sql", "model_name": "filtered_information_schema_columns", "normalized_full_path": "models/edr/metadata_store/filtered_information_schema_columns.sql"}, "model.elementary.filtered_information_schema_tables": {"name": "filtered_information_schema_tables", "unique_id": "model.elementary.filtered_information_schema_tables", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online_elementary", "table_name": "filtered_information_schema_tables", "owners": null, "tags": ["[]"], "package_name": "elementary", "description": "", "full_path": "models/edr/metadata_store/filtered_information_schema_tables.sql", "file_name": "filtered_information_schema_tables.sql", "model_name": "filtered_information_schema_tables", "normalized_full_path": "models/edr/metadata_store/filtered_information_schema_tables.sql"}, "model.jaffle_shop_online.customers": {"name": "customers", "unique_id": "model.jaffle_shop_online.customers", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "customers", "owners": ["Maayan"], "tags": ["PII"], "package_name": "jaffle_shop_online", "description": "This table has basic information about a customer, as well as some derived facts based on a customer's orders", "full_path": "models/customers.sql", "file_name": "customers.sql", "model_name": "customers", "normalized_full_path": "models/customers.sql"}, "model.jaffle_shop_online.stg_signups": {"name": "stg_signups", "unique_id": "model.jaffle_shop_online.stg_signups", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "stg_signups", "owners": ["Idan"], "tags": ["staging", "PII"], "package_name": "jaffle_shop_online", "description": "", "full_path": "models/staging/stg_signups.sql", "file_name": "stg_signups.sql", "model_name": "stg_signups", "normalized_full_path": "models/staging/stg_signups.sql"}}, "dbt_sidebar": {"jaffle_shop_online": {"models": {"files": ["model.jaffle_shop_online.orders", "model.jaffle_shop_online.customers"], "staging": {"files": ["model.jaffle_shop_online.stg_customers", "model.jaffle_shop_online.stg_payments", "model.jaffle_shop_online.stg_orders", "model.jaffle_shop_online.stg_signups"]}}}, "elementary": {"models": {"edr": {"operational_monitoring": {"files": ["model.elementary.test_run_results", "model.elementary.model_run_results"]}, "alerts": {"files": ["model.elementary.alerts_dbt_tests", "model.elementary.alerts_schema_changes", "model.elementary.alerts_data_monitoring"]}, "system": {"files": ["model.elementary.monitors_runs"]}, "test_results": {"files": ["model.elementary.elementary_test_results"]}, "dbt_artifacts": {"files": ["model.elementary.dbt_tests", "model.elementary.dbt_models", "model.elementary.dbt_sources", "model.elementary.dbt_metrics", "model.elementary.dbt_run_results", "model.elementary.dbt_exposures"]}, "data_monitoring": {"anomaly_detection": {"files": ["model.elementary.metrics_anomaly_score", "model.elementary.anomaly_threshold_sensitivity"]}, "schema_changes": {"files": ["model.elementary.schema_columns_snapshot", "model.elementary.table_changes", "model.elementary.column_changes", "model.elementary.schema_tables_snapshot"], "previous_and_current_schemas": {"files": ["model.elementary.previous_schema_tables", "model.elementary.current_schema_columns", "model.elementary.current_schema_tables", "model.elementary.previous_schema_columns"]}}, "data_monitoring": {"files": ["model.elementary.data_monitoring_metrics"]}}, "metadata_store": {"files": ["model.elementary.filtered_information_schema_columns", "model.elementary.filtered_information_schema_tables"]}}}}}, "test_results": {"model.jaffle_shop_online.stg_signups": [{"test_unique_id": "test.jaffle_shop_online.not_null_stg_signups_signup_id.872961bd89", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "stg_signups", "column_name": "signup_id", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "dbt_test", "test_sub_type": "not_null", "test_query": "select signup_id\nfrom elementary_tests.jaffle_shop_online.stg_signups\nwhere signup_id is null", "test_params": "{\"column_name\": \"signup_id\", \"model\": \"{{ get_where_subquery(ref('stg_signups')) }}\"}", "test_results": {"display_name": "Not Null - failed results sample", "results_sample": "", "error_message": "No error message", "failed_rows_count": -1}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "SIGNUP_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "max", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('max' as \n    varchar\n)\n                and upper(column_name) = upper(cast('SIGNUP_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Max", "metrics": [{"value": 1224.0, "min_value": 200.946863214, "max_value": 2878.053136786, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "e0b998bf7f6e0f4b2090e1cc0bac0ff1"}, {"value": 1819.0, "min_value": 569.547200191, "max_value": 2695.786133143, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "da14d1906c4e299b980ab4675916ed21"}, {"value": 1358.0, "min_value": 603.153498211, "max_value": 2524.846501789, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "e1046f86144135d7e7f804f323b50834"}, {"value": 1884.0, "min_value": 691.656313099, "max_value": 2564.343686901, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "8e049e46143c77e72acc3981c86d3fac"}, {"value": 1798.0, "min_value": 793.349208335, "max_value": 2519.317458332, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "5f41a38e0dbe1f84f8f211fe8446dae8"}, {"value": 1540.0, "min_value": 840.953906841, "max_value": 2438.474664587, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "a62e983cbd040606772f9cfae0528dbd"}, {"value": 1018.0, "min_value": 571.183453625, "max_value": 2552.816546375, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "07d522b6d4acfd8e3587693d07fb63c3"}, {"value": 2138.0, "min_value": 534.771907436, "max_value": 2717.228092564, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "3ffc2148a1df2d2ee3c9f6f4584e23f0"}, {"value": 2176.0, "min_value": 527.43162318, "max_value": 2834.56837682, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "068eaa2e8d2e5f4bf3fe10e2e5c8a692"}, {"value": 2202.0, "min_value": 536.836846523, "max_value": 2919.890426205, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "9f7174c946244326f5c901e8c010b8a1"}, {"value": 2170.0, "min_value": 566.437680691, "max_value": 2963.895652642, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "cae42d1af49024cc0709dfb297eac0f4"}, {"value": 2184.0, "min_value": 597.946910586, "max_value": 2996.822320183, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "0fae00bd4ada77046f7da473cfaa2172"}, {"value": 2146.0, "min_value": 636.489139622, "max_value": 3008.082288949, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "b3b3710c6059904ae1b524826ac76ac9"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "CUSTOMER_EMAIL", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "null_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('null_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_EMAIL' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Count", "metrics": [{"value": 0.0, "min_value": -1.621320344, "max_value": 2.621320344, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "a579300ef8a9f34bbe07c64142c0e125"}, {"value": 0.0, "min_value": -1.398717474, "max_value": 2.065384141, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "cac624a7528dd01c53eba3aac59403b0"}, {"value": 0.0, "min_value": -1.25, "max_value": 1.75, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "7e3a3b52c0b3c89ed2d2cab0c559734e"}, {"value": 2.0, "min_value": -2.083281573, "max_value": 3.283281573, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "c245e360a48f3fd1c6efbd6236536e84"}, {"value": 0.0, "min_value": -2.00998008, "max_value": 3.00998008, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "1b4e08550506033154fb7ed80194aece"}, {"value": 0.0, "min_value": -1.931815949, "max_value": 2.788958806, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "9d3e5855434b9dfec19b814385a38f93"}, {"value": 0.0, "min_value": -1.857071427, "max_value": 2.607071427, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "6c50450f3654f4c65a46f99bb9b84083"}, {"value": 0.0, "min_value": -1.78798701, "max_value": 2.454653677, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "a8c204d2986c0c9747e343c3d3466e51"}, {"value": 10.0, "min_value": -8.086160024, "max_value": 10.686160024, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "7859b12a84fe792e68a9e704b143c7f4"}, {"value": 6.0, "min_value": -8.140028645, "max_value": 11.594574099, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "516aef1e7a6500ea7b4b712f63f40be9"}, {"value": 7.0, "min_value": -8.291040365, "max_value": 12.624373698, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "867ad2c9139de59ac848b06e24df775e"}, {"value": 3.0, "min_value": -7.805702721, "max_value": 12.267241182, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "671499976b54813eb1f4b70bb4925ec9"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "CUSTOMER_EMAIL", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "min_length", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('min_length' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_EMAIL' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Min Length", "metrics": [{"value": 21.0, "min_value": 21.0, "max_value": 21.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "b93100e1f25cbba2e3413e90cd92cda2"}, {"value": 22.0, "min_value": 19.601282526, "max_value": 23.065384141, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "76f4c80e371c96da83fb12aa394655aa"}, {"value": 21.0, "min_value": 19.75, "max_value": 22.75, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "7a5f448b853b3b2757e1343596d345b5"}, {"value": 21.0, "min_value": 19.858359214, "max_value": 22.541640786, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "102c180bad98207c5b645d0f54beb7af"}, {"value": 22.0, "min_value": 19.784139995, "max_value": 22.882526672, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "019d39950eecb7cf20095f3cef341ec5"}, {"value": 22.0, "min_value": 19.825003977, "max_value": 23.03213888, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "2e036b7b0d95e565ae5efb5cfab77c34"}, {"value": 23.0, "min_value": 19.392928573, "max_value": 23.857071427, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "86193ebae910f1eb79a966394ffc3e08"}, {"value": 23.0, "min_value": 19.277777778, "max_value": 24.277777778, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "56c31c1f11b5b66724cd69e8abd150cf"}, {"value": 16.0, "min_value": 15.233426444, "max_value": 27.166573556, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "4de5d80162dc9a6a88e2f7544b17248c"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "SIGNUP_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "standard_deviation", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('standard_deviation' as \n    varchar\n)\n                and upper(column_name) = upper(cast('SIGNUP_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Standard Deviation", "metrics": [{"value": 402.549872687, "min_value": 213.471779128, "max_value": 708.247790519, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "39a5b2407a01711ad2852b2b1d5f64ed"}, {"value": 679.623285007, "min_value": 116.440778889, "max_value": 951.121124214, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "f682a8df0050b69a35a47707d0613c60"}, {"value": 669.630121784, "min_value": 170.705517295, "max_value": 964.780970924, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "8769db0f343a352950471b9aac10bde8"}, {"value": 625.387298182, "min_value": 226.837204304, "max_value": 931.706905544, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "06caaae2d603498b64bdba2b3e7ea4a5"}, {"value": 1214.809450078, "min_value": -154.584737294, "max_value": 1524.974645527, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "f5c95b71ecae59863a0ea4e9f9d72cac"}, {"value": 1079.044948091, "min_value": -145.743557844, "max_value": 1628.662035784, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "f6e72e2474d81b9f3e085c570c67340e"}, {"value": 457.98071284, "min_value": -168.668045604, "max_value": 1580.716892011, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "64d1e4bead10b7e3d4986bef9990d8f7"}, {"value": 26.110603907, "min_value": -433.35136091, "max_value": 1694.308247473, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "d26b0f73707ec377c4b386a0cbb3fafd"}, {"value": 100.22922446, "min_value": -544.613079623, "max_value": 1699.520122423, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "25ce5f3f77f98c8392a67ce8f57291c4"}, {"value": 68.078608753, "min_value": -628.774776792, "max_value": 1691.06819911, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "bd424abc754f876038f4c3575a3e0d01"}, {"value": 60.311414066, "min_value": -686.805624221, "max_value": 1670.626497023, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "a97526a814b3d89a34b4452122c557ae"}, {"value": 39.406912616, "min_value": -732.581150312, "max_value": 1646.786096379, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "b30314457116fc20970a9a0a9df93d8f"}, {"value": 66.017674401, "min_value": -756.07371097, "max_value": 1614.409400089, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "dfe4b3f6ac2ba882b53e2e7436a8e748"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "CUSTOMER_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "null_percent", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('null_percent' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Percent", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "1fd093ed60b81e7bd097596af60d15ed"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "ede24df0eca77bab6c175d2380146215"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "6c88c4eb46947196691569483c021390"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "b1c7f24b13e260eca21dcf3fde793bf0"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "5ca690fa76242c124aa236e9159226ce"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "274700eaeea2f8d3d323aacef394e7f6"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "bd3aaff4f146dfafedcd2a9aafe2359d"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "05c459b58005c2b1c3e0d6c6979809b3"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "b22ffec3e617fc03e58d0690186a2d54"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "106deba86565f1f1d1b08a96251a113a"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "32acadcfd0f0b712b615b4c407294df8"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "c021e5e6fb1deba345b5d0ae5cdc3799"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "42cd344dfb6c4442b2a8c93448efec47"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "CUSTOMER_EMAIL", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "null_percent", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('null_percent' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_EMAIL' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Percent", "metrics": [{"value": 0.0, "min_value": -13.510462423, "max_value": 21.843462423, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "7b8b5d371c6974770102ab4d590378c6"}, {"value": 0.0, "min_value": -11.655512713, "max_value": 17.210846046, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "e30c63ce26b519c6f9f8575f8d0966f5"}, {"value": 0.0, "min_value": -10.41625, "max_value": 14.58275, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "3399fcd5cdf93c56efc0142cc0a72ee0"}, {"value": 18.182, "min_value": -18.856546312, "max_value": 29.462546312, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "78d72235fad990e1a590590c88c2add4"}, {"value": 0.0, "min_value": -18.144734944, "max_value": 26.983068277, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "cf3de6c59ea2d8c49c5e7dcfb05e947f"}, {"value": 0.0, "min_value": -17.410809591, "max_value": 24.986523877, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "1c2f7ce3b299978e2d6e9f4755b86dcf"}, {"value": 0.0, "min_value": -16.718776948, "max_value": 23.347526948, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "c17fd62c75644bf667077df1746f5ad0"}, {"value": 0.0, "min_value": -16.084032385, "max_value": 21.976254608, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "d770ebd1dfe4b6ec03b465912970267d"}, {"value": 83.333, "min_value": -67.359022932, "max_value": 89.328622932, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "f6c05f60a33867c7652bdfee206b84fc"}, {"value": 100.0, "min_value": -90.499417413, "max_value": 128.653599231, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "a2df3ee48520246ac3620fe1209580a7"}, {"value": 100.0, "min_value": -99.984152865, "max_value": 151.625486198, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "ccae0ec2067439733fb9ccecb3100269"}, {"value": 100.0, "min_value": -103.815102301, "max_value": 166.868640763, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "e2cffd5eb1ef76053e6f4fb26dfb73f8"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "SIGNUP_DATE", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "null_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('null_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('SIGNUP_DATE' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Count", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "275c92b566e91aa11d2b2a08b70d702e"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "1ebcd634cd9495cb27301aa8c4d36ae8"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "096335502125a701cb6525d38dbd903a"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "7d4416426a61ffde7b019eb6a2694f93"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "70675f93cffaf3959d699c6b7a444bb6"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "ebea34b1bfde3028f58a3cd01eb7fa8e"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "563d0d0b910b1378ab3badc2e33ba207"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "e0bc27148faa9c79eff24f2e5c9a9732"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "45332b618625be6b105def721cc63663"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "711d00f6d489517fd75f31dd6647faf0"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "420780f4b6f2b011ff5b7365d98fc9b8"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "90f7c9cf23591ede79890efea217b771"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "CUSTOMER_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "zero_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('zero_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Zero Count", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "46dc2a4bf57c4b91a6f433e9dc945b21"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "ae2650e83675f40b664640741ade40e3"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "44f036f94b374bdb9230c9cd56312895"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "da18a69d341dd05a9e41bd184ccf8d83"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "79b7dee4769cf3a7b811fddd5f7c9418"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "4d27fa35eef4205c96a829e21740ed6a"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "fea5a3e9ac48e0f475498fb1537eb2d6"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "8098b1cb822f9de58a0dbabdb55c704f"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "d99ae75ded9778dc411b8f19f2e75ffa"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "199063e5a4c9a488d50f6931fe46f7a2"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "7c339fd4e3e2f6345fa09a0b9f6888c5"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "3e1f99726aa007417f3ab9391a4bbc32"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "33fa5f93c074e964b041dcb7137fe5d6"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "CUSTOMER_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "standard_deviation", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('standard_deviation' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Standard Deviation", "metrics": [{"value": 402.549872687, "min_value": 213.471779128, "max_value": 708.247790519, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "7b916ab677c802d25fe2967ecb54ecf8"}, {"value": 679.623285007, "min_value": 116.440778889, "max_value": 951.121124214, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "b1e06bf3fe892d0650092cf0f4b1be4f"}, {"value": 669.630121784, "min_value": 170.705517295, "max_value": 964.780970924, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "86d998bda712221824e1fe3f17d3bceb"}, {"value": 625.387298182, "min_value": 226.837204304, "max_value": 931.706905544, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "9a4c1a3f16ae5329ac8db9c6d6609c7e"}, {"value": 1214.809450078, "min_value": -154.584737294, "max_value": 1524.974645527, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "9cbb2af5f2bbc7275b0732db16750f0c"}, {"value": 1079.044948091, "min_value": -145.743557844, "max_value": 1628.662035784, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "96f887ca62a1e7b940417a66d8cf7d91"}, {"value": 457.98071284, "min_value": -168.668045604, "max_value": 1580.716892011, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "56a930b0e32f3add2cbd643246f5ae10"}, {"value": 26.110603907, "min_value": -433.35136091, "max_value": 1694.308247473, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "84440375db832a5a5d14da7a0d975037"}, {"value": 100.22922446, "min_value": -544.613079623, "max_value": 1699.520122423, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "cf41fb2b44e7fb79a06dcc33cae771a1"}, {"value": 68.078608753, "min_value": -628.774776792, "max_value": 1691.06819911, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "91f1b5a4dd5c5c2954e5ea1c49be812e"}, {"value": 60.311414066, "min_value": -686.805624221, "max_value": 1670.626497023, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "985998c3b4d33ee5fefc6119d329959a"}, {"value": 39.406912616, "min_value": -732.581150312, "max_value": 1646.786096379, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "52bb57adc79628c9533fff361180e46c"}, {"value": 66.017674401, "min_value": -756.07371097, "max_value": 1614.409400089, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "e83e9ad3270e116d918f8e8fc731bfb2"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "SIGNUP_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "variance", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('variance' as \n    varchar\n)\n                and upper(column_name) = upper(cast('SIGNUP_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Variance", "metrics": [{"value": 162046.4, "min_value": -12230.579024219, "max_value": 443814.153266644, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "2eac1aa8586d3d3d96e36b82488be1e8"}, {"value": 461887.80952381, "min_value": -157902.939823908, "max_value": 753550.529001397, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "edc0ea177c2ef7864491f60ba9ed198f"}, {"value": 448404.5, "min_value": -99819.024758362, "max_value": 770756.966641479, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "ab8cb544a205d1c380210becd2aaf47b"}, {"value": 391109.272727273, "min_value": -37693.54512673, "max_value": 730887.607724132, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "4c2ccdf45582d1cc8fd1bbca2cf2b457"}, {"value": 1475762.0, "min_value": -890222.381753732, "max_value": 1959804.76725157, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "fc3123afe87b998bbed1d3bd9a9c5a45"}, {"value": 1164338.0, "min_value": -859115.128018309, "max_value": 2108568.0298736, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "f024a2477a4ae1c55d6f766600e8330c"}, {"value": 209746.333333333, "min_value": -869706.134825474, "max_value": 2015414.00728218, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "1b75165fb069452794f1b813ac04f43d"}, {"value": 681.763636364, "min_value": -956407.656448516, "max_value": 1974966.15721812, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "19a298380c90af3512de8e23f7a78bfc"}, {"value": 10045.897435897, "min_value": -1001416.32324247, "max_value": 1920128.15342229, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "027d48be17f8c12906e4651939d998f3"}, {"value": 4634.696969697, "min_value": -1027543.36468582, "max_value": 1863578.60975287, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "38678c80c45a70ec770a7b4b19e041d5"}, {"value": 3637.466666667, "min_value": -1040754.86652031, "max_value": 1807726.75227622, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "cb28c8d8dbdc0c5f9761c967792c1774"}, {"value": 1552.904761905, "min_value": -1046040.75885127, "max_value": 1754253.71566625, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "0b81639079495f49121ab81b7dd3d63d"}, {"value": 4358.333333333, "min_value": -1045010.91356279, "max_value": 1703259.84965289, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "91595c81bad19c38387fb973ff351c35"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "CUSTOMER_EMAIL", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "average_length", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('average_length' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_EMAIL' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Average Length", "metrics": [{"value": 24.0, "min_value": 21.855282879, "max_value": 25.326535121, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "f79b1ec700d1967dac98e0aa1fd7acce"}, {"value": 24.285714, "min_value": 22.103656112, "max_value": 25.541365221, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "a1d843e82a6d9e275d43d28f85ccfb23"}, {"value": 22.5, "min_value": 21.061868968, "max_value": 25.921897032, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "095a64855a5221c210808c0e0d1168e7"}, {"value": 23.111111, "min_value": 21.250156316, "max_value": 25.581300884, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "40916f8bf40fa497fc051ffbba322097"}, {"value": 24.0, "min_value": 21.448204686, "max_value": 25.578009648, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "ea38ddb654efa0578bb60560f7eda5fc"}, {"value": 22.5, "min_value": 21.160930058, "max_value": 25.575825085, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "47f00da216676035ed43bb550c58ba7a"}, {"value": 23.333333, "min_value": 21.319959727, "max_value": 25.408034273, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "b58a716ae95a73dda40c4bd9e5ebab97"}, {"value": 23.0, "min_value": 21.377191889, "max_value": 25.269913889, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "4d2e8be80b1eba9746fea6fbd476f4b6"}, {"value": 16.0, "min_value": 15.405212574, "max_value": 29.777182626, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "c1fa510633d0b67ee3f211f90b05de3f"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "HASHED_PASSWORD", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "missing_percent", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('missing_percent' as \n    varchar\n)\n                and upper(column_name) = upper(cast('HASHED_PASSWORD' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Missing Percent", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "489c2ef842fb784477c8c7ff69e58443"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "6566eada76768a43ce7fc31882619059"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "1b6570cf204cb6adba56650db2f7e300"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "ebb9eff4ecb66e22c58b4750d39ad062"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "0927293be497137c7b7cdfaf4064e3fc"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "3be9cf276ccb200aef140b27a28b936c"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "a3eb1387bb2e1dacde4dd054323dbebf"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "e2529807e8500840a90c561f0751e9a4"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "2065f316c7b771d24189546d928fa799"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "77dcaf8dd443e0a086f692e1053d0266"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "225e9cff887d111bf82cfc660a2d1509"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "01474488bef795784735a86f122603b8"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.unique_stg_signups_signup_id.b5de363a4b", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "stg_signups", "column_name": "signup_id", "test_name": "unique", "test_display_name": "Unique", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "dbt_test", "test_sub_type": "unique", "test_query": "select\n    signup_id as unique_field,\n    count(*) as n_records\n\nfrom elementary_tests.jaffle_shop_online.stg_signups\nwhere signup_id is not null\ngroup by signup_id\nhaving count(*) > 1", "test_params": "{\"column_name\": \"signup_id\", \"model\": \"{{ get_where_subquery(ref('stg_signups')) }}\"}", "test_results": {"display_name": "Unique - failed results sample", "results_sample": "", "error_message": "No error message", "failed_rows_count": -1}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "CUSTOMER_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "null_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('null_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Count", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "c2c908cb895b73f452eae3388d00bae6"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "4fe59b06fec6ebf772456b496f8b57fb"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "24bb346641c5ac5bcb58536a65fbdcb2"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "b2313800ba3b8e15ff15a8ab127b8e03"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "a3704a24f9661b68da8224b095c64e54"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "130bd0228a06d7e4de9034b36d442e72"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "099c77d209dbf249a5d4c6b6f287b0cc"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "db6028c59a018ea00e3176821f69f375"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "a87b41736455f85d613a64fcc440a43d"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "ff4149ea9303c5243c189e94a9a72e90"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "594aae74daf282fdacc7fc187a26cb3f"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "afd1da883039bb9ce9e39d96162ecff1"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "8977e45f216836f0113bb1e287962726"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "CUSTOMER_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "zero_percent", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('zero_percent' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Zero Percent", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "f2913d69e578978f20760c44358e3dbc"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "4a27bc8c7b748e93964ff26f0d3fb322"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "15d733ce3d8fab4be3b1c44375351098"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "b9de12cc7d7d5abae2830e5327d15266"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "d444782ccc5a99d9d01dd6bf620693fb"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "85f8aa8fa05affd05736b2fa41628639"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "e94781da875d54498a84adff9b20f96b"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "71ea1797bd959c9d86a7c530b582dc91"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "04c11de5f07c50166803d69a9c61f1ca"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "77717c51a843561792cb821e1b14ae12"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "5a8294c3553b49e5e7de5b6a8e4a0171"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "16b8491f6d4debd5f5d5dbf5171ac76f"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "2888e8d20452f364d082b77dd4940c1f"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "SIGNUP_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "zero_percent", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('zero_percent' as \n    varchar\n)\n                and upper(column_name) = upper(cast('SIGNUP_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Zero Percent", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "6244d08874cf6a61c858f5950ea46a89"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "a95f36576b2c417aabc2c2e5fbbe6412"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "ce9ff98d7509b62f93647bc96d83b457"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "0ccd2dd0085bbfd3f6d54e6b6a240472"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "5577cbad77aa00f4e248ccace9f947f9"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "53a66d96f69879d35a5d1350d6a2c36f"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "974169d7676d80afa2e10b8002d90b7b"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "dd0dc6ea5386c57b03f0e6debfa40585"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "6aa3f6043b41d7f3ae939a47429f1333"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "053ba8bf30108d6cf929880b2f3dc361"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "d27afb42e278960aa41b67ed0142c57e"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "cd4e74d25b1d608b2d0b6c4ab0ed299b"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "1757bd1aaa5ebb64d35f5c4d223132c3"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "HASHED_PASSWORD", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "max_length", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('max_length' as \n    varchar\n)\n                and upper(column_name) = upper(cast('HASHED_PASSWORD' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Max Length", "metrics": [{"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "33be3924d0a3a578a88c0f74e09d1327"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "5d2d3c6fc3ab41b1cceccc38186ebfbc"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "1fdb22406c4ac604e8e83c64329ba57f"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "0eae292af7d8c235e8ff273a29c01515"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "858c67ac39b68ce0927d491a8fc31e60"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "6e4064037aa69b96ffc3993961361c69"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "3da4ba756a2177cc0d3456c10b38bf15"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "8006dd5b64a19d0aaaa6de0975b1db34"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "99203c0b344be68670741c3ed359152b"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "71e8ec2f9b287682c99e87c5183a7024"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "2298a8d61f6793d9031529b49baf85a9"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "ed7c202df9238f6bd7b8de5228a7a989"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "SIGNUP_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "average", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('average' as \n    varchar\n)\n                and upper(column_name) = upper(cast('SIGNUP_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Average", "metrics": [{"value": 544.0, "min_value": 54.226146216, "max_value": 1335.857187117, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "3451619530ef3af353ca01731acc1887"}, {"value": 933.857142857, "min_value": 161.115440194, "max_value": 1388.1782106, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "f05e71da01cbcfcfee88802d429ccb3a"}, {"value": 884.5, "min_value": 274.758676757, "max_value": 1329.461561338, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "e5013d623527567c785b6d4c9828d045"}, {"value": 1191.545454545, "min_value": 186.050183325, "max_value": 1573.94418897, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "c9d25796bec2c5b4f7ef99db2ae8b61d"}, {"value": 939.0, "min_value": 264.953438655, "max_value": 1514.708538257, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "f49614fd64b8b7d5dbee22ed41dffc3e"}, {"value": 777.0, "min_value": 289.108558715, "max_value": 1458.315992924, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "4265e720e7884887341deef97991d96c"}, {"value": 648.333333333, "min_value": 253.861312875, "max_value": 1437.218503143, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "e4bb97f35daa8ebfdc5368b52fcc5344"}, {"value": 2091.818181818, "min_value": -379.631548609, "max_value": 2347.66209214, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "635f6fc3ae25623ec85abae7dfc0f637"}, {"value": 2052.692307692, "min_value": -546.426237392, "max_value": 2728.192188107, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "5c24e79b1a6fbccd67f6f0776a2f0223"}, {"value": 2097.833333333, "min_value": -618.214294274, "max_value": 2983.062128258, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "3590e11e372963d17e5d590c9ac72417"}, {"value": 2053.333333333, "min_value": -620.208557616, "max_value": 3130.20796099, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "94562bb4f1b455e5135d5dbac85d8ca8"}, {"value": 2127.285714286, "min_value": -614.428486719, "max_value": 3258.625738186, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "3f9e38397d4fe749be6fbe6aa732ece3"}, {"value": 2087.666666667, "min_value": -582.411692313, "max_value": 3335.97580677, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "4157f4e1b8ebded379ca87151da5b3dd"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "CUSTOMER_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "average", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('average' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Average", "metrics": [{"value": 544.0, "min_value": 54.226146216, "max_value": 1335.857187117, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "02f1a713ac24e27ba085d489e679ce6a"}, {"value": 933.857142857, "min_value": 161.115440194, "max_value": 1388.1782106, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "dd785e501d93638734a153a26f855a9e"}, {"value": 884.5, "min_value": 274.758676757, "max_value": 1329.461561338, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "c4743f677e3c1843e2b6392cb8b0c4b7"}, {"value": 1191.545454545, "min_value": 186.050183325, "max_value": 1573.94418897, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "1e3c150f37bb6a2d154c7cd2db027486"}, {"value": 939.0, "min_value": 264.953438655, "max_value": 1514.708538257, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "5d403f11b98dffc23c9a2596ebfc04a1"}, {"value": 777.0, "min_value": 289.108558715, "max_value": 1458.315992924, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "9a6793b547fd912e8512435217c536f7"}, {"value": 648.333333333, "min_value": 253.861312875, "max_value": 1437.218503143, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "4c9bbe454097c63f8db087f6a10ff8f7"}, {"value": 2091.818181818, "min_value": -379.631548609, "max_value": 2347.66209214, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "052e97b30fad275402ae2dea3626447c"}, {"value": 2052.692307692, "min_value": -546.426237392, "max_value": 2728.192188107, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "d4369be7ad8b11db72fd0e6bc730eb4f"}, {"value": 2097.833333333, "min_value": -618.214294274, "max_value": 2983.062128258, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "a72adc1a1a8f5595e007e0e0dbab3f22"}, {"value": 2053.333333333, "min_value": -620.208557616, "max_value": 3130.20796099, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "eda055772797f3818ab7e6998df40cad"}, {"value": 2127.285714286, "min_value": -614.428486719, "max_value": 3258.625738186, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "61142eade1b33ddeb7ad76592d658778"}, {"value": 2087.666666667, "min_value": -582.411692313, "max_value": 3335.97580677, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "d88f36e3f313a95dbc635212ceea6574"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "SIGNUP_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "null_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('null_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('SIGNUP_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Count", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "928c3394d0673fde09ba81d6ba83d168"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "99893d9d29aec42b82f2fa9c0bfcc5bd"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "523867cb477d30b7d5c91edbf3dee812"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "1913a281bda5945a8926e027111b20ed"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "2c9cf7bae24f5784d9b64686e85a5a22"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "0a7b36ec7f3f291507a620eb9ccb24c6"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "ff3f729381dcb3254ae3180c99cfebab"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "cff59d1951860489d8a92674ebe0b099"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "fe6868c60fcca24dc52a724bebd98388"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "8e19babc7cb43fb0f0d2827c0353614e"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "f523c14cd9df6b632c7ad2ee101f716f"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "9e6d22778e570fb69da8af157ee34707"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "996bbf58a8a18c334c980bc6b56a4f1b"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "CUSTOMER_EMAIL", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "missing_percent", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('missing_percent' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_EMAIL' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Missing Percent", "metrics": [{"value": 0.0, "min_value": -13.510462423, "max_value": 21.843462423, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "e6efa40e6cb3956036b62f84e886da7f"}, {"value": 0.0, "min_value": -11.655512713, "max_value": 17.210846046, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "d2d6a1781f79cf8cbbd2f47ce892698f"}, {"value": 0.0, "min_value": -10.41625, "max_value": 14.58275, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "2d287a8943145bfb5cbecbe13fb1c933"}, {"value": 18.182, "min_value": -18.856546312, "max_value": 29.462546312, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "f78be620e30d8eb1562b0e23d430b0c0"}, {"value": 0.0, "min_value": -18.144734944, "max_value": 26.983068277, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "e200a28a6b2c1824362bd532a2d08764"}, {"value": 0.0, "min_value": -17.410809591, "max_value": 24.986523877, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "28137e5f3e743fe534300f0d10b9154f"}, {"value": 0.0, "min_value": -16.718776948, "max_value": 23.347526948, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "d3a590a506cbd2f865da8262080543cb"}, {"value": 0.0, "min_value": -16.084032385, "max_value": 21.976254608, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "27104b2acf5b36fccb2c561a8f3b9f55"}, {"value": 83.333, "min_value": -67.359022932, "max_value": 89.328622932, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "5247cfa1454851712f43a04d48810d5a"}, {"value": 100.0, "min_value": -90.499417413, "max_value": 128.653599231, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "2dc1eb09a0f442f157c99054d1ca7b54"}, {"value": 100.0, "min_value": -99.984152865, "max_value": 151.625486198, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "90cbc408dcf091fc641d3a13cd086eda"}, {"value": 100.0, "min_value": -103.815102301, "max_value": 166.868640763, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "2f56311e840def66e9a944d7606b3429"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "SIGNUP_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "null_percent", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('null_percent' as \n    varchar\n)\n                and upper(column_name) = upper(cast('SIGNUP_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Percent", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "c6c01b1a04c85d9ede0fa642ff7f370c"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "ce3e5c2b5dd45ebb0b77d43437ba2431"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "01199e01b03687b48ad68eeaccb0c77d"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "fa4dd2cf623bffb9af360561a1807f99"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "b8bb5c6ceae5835039e67294dafa3acf"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "057cada6da442ccc62e0d4842947c1ea"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "87c682d3febcb77a18a70e913ed04e55"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "cb88241dd8739d73ef32fdf71bde8b9b"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "406839d7925600b1afcadd7841a63748"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "62bdeabb3959c9324a98e15d2e604d9c"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "bf53d6c358124cd0a5394257349ddbcc"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "acb609e9b96f6102d238b9797b672412"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "643530038c307b1a7fe1ec31e8270860"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "HASHED_PASSWORD", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "min_length", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('min_length' as \n    varchar\n)\n                and upper(column_name) = upper(cast('HASHED_PASSWORD' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Min Length", "metrics": [{"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "c952db8d1255a178f9614073c0f3b3ec"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "f10ebbeb64b14074172bf68db4a174d9"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "f33c1ca5a0ff554939048e93b2679883"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "b00f95cf650fc47815885587d2d78ea7"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "4eff1c875128d7e5a56039f2e0453a36"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "effc35091bc84e71367f860342d5dd7c"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "a8eddb8d9edfd03b71c0b57f0b0a4c96"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "b78503980ffc8c29efd5d12fa7b4b4d8"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "16b3b9b371dc82ce76e3ba9319157b5a"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "65de447aea428aef78c6f334bda01806"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "7e557b7b5764079b868c7a4866523de5"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "1fd3f77103a34f890548975bd7e1a8aa"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "CUSTOMER_EMAIL", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "max_length", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('max_length' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_EMAIL' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Max Length", "metrics": [{"value": 28.0, "min_value": 20.136038969, "max_value": 32.863961031, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "9fd7bb50406489fea409630e91d0b90d"}, {"value": 26.0, "min_value": 21.750757638, "max_value": 30.915909028, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "d9eeb4930cc6160ab31f28b609741a43"}, {"value": 24.0, "min_value": 20.626524617, "max_value": 30.873475383, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "aec0c9f127e0f7e8870ba6ff6d60fb05"}, {"value": 25.0, "min_value": 21.050274734, "max_value": 30.149725266, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "87c5c8005fabbf2c4e1dcbcf6705d18b"}, {"value": 26.0, "min_value": 21.56788636, "max_value": 29.765446973, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "f5c9ef980230d1b25839f24ba795d413"}, {"value": 23.0, "min_value": 20.475011931, "max_value": 30.09641664, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "73d7f1145eca225ec75b8a13ca28981f"}, {"value": 24.0, "min_value": 20.467057474, "max_value": 29.782942526, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "e76b037d610b73f3b9d5ee342ca5cb68"}, {"value": 23.0, "min_value": 20.041209031, "max_value": 29.736568746, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "fa829beee2be7218c85968867674b3f9"}, {"value": 16.0, "min_value": 14.408336953, "max_value": 33.591663047, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "e8fe68467db117e8cd4ba5c960b45330"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "CUSTOMER_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "max", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('max' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Max", "metrics": [{"value": 1224.0, "min_value": 200.946863214, "max_value": 2878.053136786, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "337313f6e7dd1a4c9056888d27cf2d5b"}, {"value": 1819.0, "min_value": 569.547200191, "max_value": 2695.786133143, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "459e70d49b5fdfd9eba439ce57c1d965"}, {"value": 1358.0, "min_value": 603.153498211, "max_value": 2524.846501789, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "437b0d9d97dcefd94026f6eae72f786a"}, {"value": 1884.0, "min_value": 691.656313099, "max_value": 2564.343686901, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "ee36c68b6d86c55bced1c51ea7daf630"}, {"value": 1798.0, "min_value": 793.349208335, "max_value": 2519.317458332, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "f29f4c1487d31a90a45e1e91acd28e50"}, {"value": 1540.0, "min_value": 840.953906841, "max_value": 2438.474664587, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "a348ca3b8ef87b0bae22666db3382109"}, {"value": 1018.0, "min_value": 571.183453625, "max_value": 2552.816546375, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "94adf508244bb0a270d32c19123a361d"}, {"value": 2138.0, "min_value": 534.771907436, "max_value": 2717.228092564, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "d6e1326374b121f40f6721edc19c9103"}, {"value": 2176.0, "min_value": 527.43162318, "max_value": 2834.56837682, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "c8ad6e6ef1d018fa478be11649963318"}, {"value": 2202.0, "min_value": 536.836846523, "max_value": 2919.890426205, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "d7362462b8e91f5596f9d4a43e196ced"}, {"value": 2170.0, "min_value": 566.437680691, "max_value": 2963.895652642, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "8fa41eddde58f2cb3008a19269c094ad"}, {"value": 2184.0, "min_value": 597.946910586, "max_value": 2996.822320183, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "a34fb168ca3b4963b2459c09f73d9708"}, {"value": 2146.0, "min_value": 636.489139622, "max_value": 3008.082288949, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "86b3c400ffd01dee2808cf7fbd64bb38"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "HASHED_PASSWORD", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "average_length", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('average_length' as \n    varchar\n)\n                and upper(column_name) = upper(cast('HASHED_PASSWORD' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Average Length", "metrics": [{"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "66e4d162512da18c01231484ea76eb72"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "8fa20ef59ecb9b59a18826d53ea6ce03"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "426fc177a5c8dbb7ac899c532178ca4e"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "e7338f31f6b57088c298dbe61069287f"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "7dedabe8cbaed71347c19616d834d6e7"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "ed07f7fd51b52b86bf561b46178ebc91"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "b02da8f1f49ea755c682258179fbdea6"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "d0a4f3b66515f52d273b3dd067e53bc5"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "ceb2cc55dc681b1bf8eae8c32ae31713"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "56ec27c9cf51332c0a09359ff10d686a"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "6d0da2a3fa90639caeb6521e1f0aeae2"}, {"value": 64.0, "min_value": 64.0, "max_value": 64.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "3b367d7621b9def3be8d1586f25aa2b3"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "HASHED_PASSWORD", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "null_percent", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('null_percent' as \n    varchar\n)\n                and upper(column_name) = upper(cast('HASHED_PASSWORD' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Percent", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "fa1515bfaa2b9bcbdc345221cfe689ed"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "088f4d048f996a567e51d7244cfd54e1"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "c174dbd56cae32712bb417ea1e27ce97"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "74fab287c5fe132557c85a3bf1a308ee"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "6698a0ec9762b3d46f49344614f112d0"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "97d30a88da983f7f6291ca1e48556a8f"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "12a46c1dce7bb591ea70bd98d37c94ce"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "8768466deb7f79deb6e8209e7fcb79b6"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "5e00dda0579943bfd51cd26de8732fec"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "b148cc0a7bc93438a496e991ef86b200"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "639d2bf2cab65b33bdceedb92fcd25a7"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "3df137d1261a83d63062cac3cdc08d80"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.unique_stg_signups_customer_email.aef0183677", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "stg_signups", "column_name": "customer_email", "test_name": "unique", "test_display_name": "Unique", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "fail", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "dbt_test", "test_sub_type": "unique", "test_query": "select\n    customer_email as unique_field,\n    count(*) as n_records\n\nfrom elementary_tests.jaffle_shop_online.stg_signups\nwhere customer_email is not null\ngroup by customer_email\nhaving count(*) > 1", "test_params": "{\"column_name\": \"customer_email\", \"model\": \"{{ get_where_subquery(ref('stg_signups')) }}\"}", "test_results": {"display_name": "Unique - failed results sample", "results_sample": [{"unique_field": "abcd@example.com", "n_records": 2.0}], "error_message": "Got 1 result, configured to fail if != 0", "failed_rows_count": 1}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "CUSTOMER_EMAIL", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "missing_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('missing_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_EMAIL' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Missing Count", "metrics": [{"value": 0.0, "min_value": -1.621320344, "max_value": 2.621320344, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "9ab93b92caf1f9a450b7759db3353da6"}, {"value": 0.0, "min_value": -1.398717474, "max_value": 2.065384141, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "586c39d777e8362938d4ca7f9a61c017"}, {"value": 0.0, "min_value": -1.25, "max_value": 1.75, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "2360b24305b9fdb20c573a26a1a4d039"}, {"value": 2.0, "min_value": -2.083281573, "max_value": 3.283281573, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "5e4f34db895143f72bdb98e35e81d526"}, {"value": 0.0, "min_value": -2.00998008, "max_value": 3.00998008, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "007a13857c18331c859a24add5b79141"}, {"value": 0.0, "min_value": -1.931815949, "max_value": 2.788958806, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "ba745cf246608cb8580eb72679bcd174"}, {"value": 0.0, "min_value": -1.857071427, "max_value": 2.607071427, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "c1415a996b0048369aba3bf6f114b5e4"}, {"value": 0.0, "min_value": -1.78798701, "max_value": 2.454653677, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "c973d3376cd5231e2c3d47be56a92ca3"}, {"value": 10.0, "min_value": -8.086160024, "max_value": 10.686160024, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "ca662862a1202e1a67963b4a1b4e0806"}, {"value": 6.0, "min_value": -8.140028645, "max_value": 11.594574099, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "488eef9808ba9fe0176f7b30732ab9bd"}, {"value": 7.0, "min_value": -8.291040365, "max_value": 12.624373698, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "fea9583867493ece841f6cf67244578b"}, {"value": 3.0, "min_value": -7.805702721, "max_value": 12.267241182, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "d4a8dfeac6a221bf1a132d908a1e3596"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "SIGNUP_DATE", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "null_percent", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('null_percent' as \n    varchar\n)\n                and upper(column_name) = upper(cast('SIGNUP_DATE' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Percent", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "e13dcdfbe67b5cd2c9ce6891139fd12a"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "3b25fe3f87d2c011c292a43fd4cc62fe"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "a465644f138ebe8dffcce51879a488fc"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "fbc63983993398195d0158576445cdfc"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "e56766bf4191158d6df11ac015f1238e"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "91fef80f4ffd700de4bb80bbe942c627"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "f206e28ce61fb39cbe8f35a6dd68e321"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "51139b9e2ad4098bc4cd7ab6ee50f26c"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "a732d659f984bfe014155e576be99535"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "acd5c94baa725e42e28e05e6c262a232"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "4a0f678ebe68a8b7763ec15ee1c35c43"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "0b617cf205a8bc9801148c5c083b77e6"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_column_anomalies_stg_signups_missing_count__customer_email__2.f505eaf508", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "CUSTOMER_EMAIL", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "latest_run_time": "2022-06-16 23:33:04", "latest_run_time_utc": "2022-06-16 20:33:04", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "missing_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_COLUMN_ANOMALIES_STG_SIGNUPS_MISSING_COUNT__CUSTOMER_EMAIL__2__ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 2\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('missing_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_EMAIL' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 2}, "test_results": {"display_name": "Missing Count", "metrics": [{"value": 0.0, "min_value": -0.9142135624, "max_value": 1.914213562, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "9ab93b92caf1f9a450b7759db3353da6"}, {"value": 0.0, "min_value": -0.821367205, "max_value": 1.488033872, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "586c39d777e8362938d4ca7f9a61c017"}, {"value": 0.0, "min_value": -0.75, "max_value": 1.25, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "2360b24305b9fdb20c573a26a1a4d039"}, {"value": 2.0, "min_value": -1.188854382, "max_value": 2.388854382, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "5e4f34db895143f72bdb98e35e81d526"}, {"value": 0.0, "min_value": -1.173320053, "max_value": 2.173320053, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "007a13857c18331c859a24add5b79141"}, {"value": 0.0, "min_value": -1.145020156, "max_value": 2.002163014, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "ba745cf246608cb8580eb72679bcd174"}, {"value": 0.0, "min_value": -1.113047618, "max_value": 1.863047618, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "c1415a996b0048369aba3bf6f114b5e4"}, {"value": 0.0, "min_value": -1.080880229, "max_value": 1.747546896, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "c973d3376cd5231e2c3d47be56a92ca3"}, {"value": 10.0, "min_value": -4.957440016, "max_value": 7.557440016, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "ca662862a1202e1a67963b4a1b4e0806"}, {"value": 6.0, "min_value": -4.850928187, "max_value": 8.305473642, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "488eef9808ba9fe0176f7b30732ab9bd"}, {"value": 7.0, "min_value": -4.805138021, "max_value": 9.138471355, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "fea9583867493ece841f6cf67244578b"}, {"value": 3.0, "min_value": -4.46021207, "max_value": 8.921750532, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "d4a8dfeac6a221bf1a132d908a1e3596"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "HASHED_PASSWORD", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "null_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('null_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('HASHED_PASSWORD' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Count", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "1d8d54e8c1a4ccce453ae8e63a553f26"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "7f6d5a146843369b4966939da468240e"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "5e9b96c8b40699f22280f73bdf5e4d3a"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "4c2dc6d8eda4e1f846cd45ef1b1225b8"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "4e55ef6ec84b1e8721f6fbd5820437c4"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "39408ec6b2547be2831463b3302e1b71"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "02e27c9df3c5d77bb80fcfc0b2925180"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "8e1ac99471aa6acf07df22a1adb0014b"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "ca01032d8d0ac273ca1e493265b3fd88"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "04a403f254b013d3b5f17dbbad8eacaa"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "288a3f59e2b22b429062fba9e00f67b3"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "5529158ec22d681456477ce5c8b5fe9f"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "SIGNUP_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "min", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('min' as \n    varchar\n)\n                and upper(column_name) = upper(cast('SIGNUP_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Min", "metrics": [{"value": 115.0, "min_value": -13.444696834, "max_value": 194.444696834, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "7685fa7ef1000231a5dc1807e7784457"}, {"value": 221.0, "min_value": -103.682561413, "max_value": 371.682561413, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "491d14095fc2b196ec5b6fb647b43ab4"}, {"value": 411.0, "min_value": -255.337232705, "max_value": 661.837232705, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "3a6fc71beb65393435f495ca973eff53"}, {"value": 107.0, "min_value": -233.614654915, "max_value": 601.614654915, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "42aece9b4d0c1ddb4cf58b7812ed843d"}, {"value": 80.0, "min_value": -227.979503972, "max_value": 561.312837306, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "fd59d21e90938ea590ea16b4527eb37b"}, {"value": 14.0, "min_value": -254.835596274, "max_value": 544.549881988, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "c3a53f9961acbd80a434392b73716a71"}, {"value": 136.0, "min_value": -226.412802021, "max_value": 513.912802021, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "3a3b1d39274c61d8ef0445a38963e2ff"}, {"value": 2058.0, "min_value": -1588.869411981, "max_value": 2301.75830087, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "e7eb75a54fbd7848590d0fdc5ad52ebd"}, {"value": 1770.0, "min_value": -1774.225439998, "max_value": 2769.825439998, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "126d6d0a8649800d6e5d5969f7dad6bc"}, {"value": 2018.0, "min_value": -1920.699904173, "max_value": 3192.699904173, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "adde944a9f320e523fd4d86a0f8dbc0a"}, {"value": 2006.0, "min_value": -1960.947981659, "max_value": 3461.281314992, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "9d2e629b272995912762ffb724f869d0"}, {"value": 2070.0, "min_value": -1966.74752259, "max_value": 3670.132137975, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "795aef3b85bb4388d4a4c3b46d481617"}, {"value": 2016.0, "min_value": -1929.409220838, "max_value": 3799.123506553, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "3237c01ab4d281d043a19fccf5302aa4"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "HASHED_PASSWORD", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "missing_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('missing_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('HASHED_PASSWORD' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Missing Count", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "0d02ec969a65f02cf02438d975d69d62"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "a411b9be25ee76921a9e8b232ad01811"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "106b9056e80ca60b2c46e124e2ce4569"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "25c281fc2ae6d925028586dd164fbb70"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "21b556f5820c41e2364e04801ba75b07"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "f93032e56a37e6901b915d97830dcebf"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "8fb270b32577955bab7598d115ec05b4"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "7a6496deb674142578806d89f021541f"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "0b2765cd8d95ff6b56ae9472e70e2184"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "65f9c1f3e01ca34061c5ce2febe04aa0"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "aad4e68634346e4919db0d333536c605"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "fb9fffb5b844bad68ca0c72a93e6a3c9"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "CUSTOMER_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "min", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('min' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Min", "metrics": [{"value": 115.0, "min_value": -13.444696834, "max_value": 194.444696834, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "33a5c333097ad227ee704c9d28f9a004"}, {"value": 221.0, "min_value": -103.682561413, "max_value": 371.682561413, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "e9b94fe110d0ed31b16d7a23e5cfac15"}, {"value": 411.0, "min_value": -255.337232705, "max_value": 661.837232705, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "4d7e922fc92963b40b582127b25609fd"}, {"value": 107.0, "min_value": -233.614654915, "max_value": 601.614654915, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "73cdfe226411ea6a7639e7b01b21a5d8"}, {"value": 80.0, "min_value": -227.979503972, "max_value": 561.312837306, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "d024b9cbbdf7f72fc8bec0df6c62bd99"}, {"value": 14.0, "min_value": -254.835596274, "max_value": 544.549881988, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "926895196b7e0ab1e6e42297359b0c90"}, {"value": 136.0, "min_value": -226.412802021, "max_value": 513.912802021, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "c2782a2e3cd2b348f899d28710275d7b"}, {"value": 2058.0, "min_value": -1588.869411981, "max_value": 2301.75830087, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "be2595d267cdfd871fa578b808417317"}, {"value": 1770.0, "min_value": -1774.225439998, "max_value": 2769.825439998, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "4608afd153c8188974e96dd39b7a9601"}, {"value": 2018.0, "min_value": -1920.699904173, "max_value": 3192.699904173, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "e7c606efb9b334364563f5250339c762"}, {"value": 2006.0, "min_value": -1960.947981659, "max_value": 3461.281314992, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "d8ca6e04531ac4ecabc183890f9f3393"}, {"value": 2070.0, "min_value": -1966.74752259, "max_value": 3670.132137975, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "2d856c142963e9094ef93d30f3395f74"}, {"value": 2016.0, "min_value": -1929.409220838, "max_value": 3799.123506553, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "179af09fc8d5c1dabcf23ff4b3a3bd90"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "SIGNUP_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "zero_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('zero_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('SIGNUP_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Zero Count", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "50ce99267f4bb4b06b8d3f6eddba6255"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "beb22a33fb3de78ba97a839b56f28e3f"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "66f664894ead0efa27ad87def94e0964"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "297c56b98fa0fcfe2821a407b7d84f3f"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "cfa2c1e85bc6b85b1243c616dd297d2c"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "33fd1e348037208d542aeca971df1f78"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "04f32431d1b2f42109d39285c09c941a"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "de6849d31352a927bfbe1f4776bc4f7f"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "ffc427a59a5869e2627502b13954254b"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "91d36f07ee3f2d46cd3f9af215c38210"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "69a4711e82240393e78c1c8a4bf3e86d"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "b43cb8ff672dc700f6469a83953711e5"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "6500763ee103569b64b1fe0af2f93eb3"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_stg_signups_.2b71cae4c3", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_SIGNUPS", "column_name": "CUSTOMER_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:03", "latest_run_time_utc": "2022-06-16 20:33:03", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_signups", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_signups", "test_type": "anomaly_detection", "test_sub_type": "variance", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_STG_SIGNUPS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_SIGNUPS' as \n    varchar\n))\n              and metric_name = cast('variance' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Variance", "metrics": [{"value": 162046.4, "min_value": -12230.579024219, "max_value": 443814.153266644, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "10173e222f4bd8e426311bd4b74056b9"}, {"value": 461887.80952381, "min_value": -157902.939823908, "max_value": 753550.529001397, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "cc3126b989005e33c57daaed04e0481c"}, {"value": 448404.5, "min_value": -99819.024758362, "max_value": 770756.966641479, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "c8ca1790486c78c80b78aaf19a48b000"}, {"value": 391109.272727273, "min_value": -37693.54512673, "max_value": 730887.607724132, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "146cd213ad3dbe030fa415546440a3a5"}, {"value": 1475762.0, "min_value": -890222.381753732, "max_value": 1959804.76725157, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "8e75698b533a3f343c3fcaa3e8a3fc71"}, {"value": 1164338.0, "min_value": -859115.128018309, "max_value": 2108568.0298736, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "bb107fd4531a153736859ca638b52599"}, {"value": 209746.333333333, "min_value": -869706.134825474, "max_value": 2015414.00728218, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "9a7bd61e2c2cefcd4e878071145a44e8"}, {"value": 681.763636364, "min_value": -956407.656448516, "max_value": 1974966.15721812, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "e187c42c9f22c9e9a1f742da9bf33f2d"}, {"value": 10045.897435897, "min_value": -1001416.32324247, "max_value": 1920128.15342229, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "9b6dea52f8b3e412e4b7f88647eedede"}, {"value": 4634.696969697, "min_value": -1027543.36468582, "max_value": 1863578.60975287, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "19f0a4e5fe2a7c8e9db1724a0828cbd2"}, {"value": 3637.466666667, "min_value": -1040754.86652031, "max_value": 1807726.75227622, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "a3a4cb7d8ad7880773e214ae5113304f"}, {"value": 1552.904761905, "min_value": -1046040.75885127, "max_value": 1754253.71566625, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "e13633572455557d301650ea3a1fc98d"}, {"value": 4358.333333333, "min_value": -1045010.91356279, "max_value": 1703259.84965289, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "e93d5b8c26abacab351f577276540672"}], "result_description": ""}}], "model.jaffle_shop_online.customers": [{"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "CUSTOMER_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "null_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('null_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Count", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "4775e374e4747373eb78ad0ad68a9e68"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "a31f49250fd5ad25810c0ca8a9881f40"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "c6d51eedbf2e19ff4b3e4f833ebbf8ba"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "bde60f186e1b9b642225d49068e0ee64"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "45489aeb471245d577cf93423215de0d"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "cf25373726de7fd6c96934487c22700f"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "bb8b00d80cce778ef07ff910455ae27a"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "4537bdf1b58a7180ae34bbfb58090461"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "3a3affe5fd76c46cd1ce8462197929af"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "dab1f11c11e9d9c512fea47f52e6de4b"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "55986e2bf74551a3a6729d8c3eccecfd"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "f54ba5807add84aed138c7f56271a929"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "24304e848759dca1971487078b9e3da8"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "FIRST_NAME", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "average_length", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('average_length' as \n    varchar\n)\n                and upper(column_name) = upper(cast('FIRST_NAME' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Average Length", "metrics": [{"value": 6.833333, "min_value": 5.085787852, "max_value": 7.914212148, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "1529fea5780b2de116137470ac3d44cb"}, {"value": 6.857143, "min_value": 5.443185699, "max_value": 7.794909634, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "75381fbb141d4a1a7c2d81ad29057049"}, {"value": 5.0, "min_value": 3.602825027, "max_value": 8.825746473, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "5f3cd47ceab43b7aacbd8f2857807d6b"}, {"value": 5.272727, "min_value": 3.435500199, "max_value": 8.616447801, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "47e1e313c542da66336633d4901c401c"}, {"value": 7.0, "min_value": 3.582254571, "max_value": 8.794368762, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "a1394a76e3dc8a96fa4c9442154c4a0a"}, {"value": 5.5, "min_value": 3.586234642, "max_value": 8.593728215, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "28686a34fd1b2d39330c7fab58504f3b"}, {"value": 6.0, "min_value": 3.758750714, "max_value": 8.398716786, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "88e5a3f119b4edb731ae28e577f61d3a"}, {"value": 5.0, "min_value": 3.535406345, "max_value": 8.382342544, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "17564512b2ce6339d7b66b3455a081cc"}, {"value": 5.0, "min_value": 3.403695172, "max_value": 8.322278828, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "c9b82a7f58a409d32771d096c9a43d73"}, {"value": 5.25, "min_value": 3.409191062, "max_value": 8.205330756, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "77b8968df16a9996dc1ebe7ad926d9d1"}, {"value": 6.5, "min_value": 3.501123663, "max_value": 8.228854671, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "7710846f50595a14a3a39108dbb55124"}, {"value": 6.0, "min_value": 3.609359513, "max_value": 8.141389718, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "cfa5fe79bbc07a6e1e50a4b9b46c3ac3"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "FIRST_NAME", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "min_length", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('min_length' as \n    varchar\n)\n                and upper(column_name) = upper(cast('FIRST_NAME' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Min Length", "metrics": [{"value": 4.0, "min_value": 4.0, "max_value": 4.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "9fb63b5fe46b75c3a3df94255dbba16a"}, {"value": 5.0, "min_value": 2.601282526, "max_value": 6.065384141, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "e1bb8fe1bc0c957f8179cc0f6591a9ff"}, {"value": 4.0, "min_value": 2.75, "max_value": 5.75, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "f93a23df995391ae3fd4d24166f204d7"}, {"value": 4.0, "min_value": 2.858359214, "max_value": 5.541640786, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "3c2649fad781d89c18f5046552c91584"}, {"value": 6.0, "min_value": 1.99001992, "max_value": 7.00998008, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "6d7c82e2cf9c4e9510a886b360f9e347"}, {"value": 4.0, "min_value": 2.068184051, "max_value": 6.788958806, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "9fbc662644f6b7946f9015b6282873df"}, {"value": 5.0, "min_value": 2.232213162, "max_value": 6.767786838, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "8f861a32b743bb4ac5d022825de6cdb6"}, {"value": 5.0, "min_value": 2.376106084, "max_value": 6.735005027, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "e34f83f9e91a99e3ae7d0aee87031355"}, {"value": 4.0, "min_value": 2.378679656, "max_value": 6.621320344, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "42997f77bc1bcd0a0e33e53ba72e0746"}, {"value": 4.0, "min_value": 2.391890502, "max_value": 6.517200407, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "9ba66cc6f965021696f71b96fe847e81"}, {"value": 6.0, "min_value": 2.20444895, "max_value": 6.962217717, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "d130c8c393b5600640c1e4f1aa47c4ff"}, {"value": 4.0, "min_value": 2.209711461, "max_value": 6.867211616, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "f2f4781268742d5f0af0019fd316ca8f"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "CUSTOMER_EMAIL", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "missing_percent", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('missing_percent' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_EMAIL' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Missing Percent", "metrics": [{"value": 0.0, "min_value": -13.510462423, "max_value": 21.843462423, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "108d376e2cb8b2f0b45fc6779a9bacda"}, {"value": 0.0, "min_value": -11.655512713, "max_value": 17.210846046, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "859e0318131888804e5546c2708c5de9"}, {"value": 0.0, "min_value": -10.41625, "max_value": 14.58275, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "352680d48726fa237a0c20085a49784f"}, {"value": 18.182, "min_value": -18.856546312, "max_value": 29.462546312, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "7e13e9ca14d4e5a0fc45f1e20a887372"}, {"value": 0.0, "min_value": -18.144734944, "max_value": 26.983068277, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "d94b777256384f2ce40032228fe350bf"}, {"value": 0.0, "min_value": -17.410809591, "max_value": 24.986523877, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "e74d9a9ff6fa8369b3284c836a36a35a"}, {"value": 0.0, "min_value": -16.718776948, "max_value": 23.347526948, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "7945447252f209f46e39319ba49038a5"}, {"value": 0.0, "min_value": -16.084032385, "max_value": 21.976254608, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "aed6f957f9b5f8ed13ee2407f87ef019"}, {"value": 100.0, "min_value": -81.153721019, "max_value": 106.456721019, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "8bc11c018218968da9be4fc1b60c71b7"}, {"value": 100.0, "min_value": -98.411965939, "max_value": 139.596511394, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "92a691cff0205c46a18da043166abde8"}, {"value": 100.0, "min_value": -105.469517644, "max_value": 159.888684311, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "2c7460a988dc5145f3a9aa5597f743b9"}, {"value": 100.0, "min_value": -107.921105338, "max_value": 173.538797645, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "0bf03d92d57445022c91fa790eee3ffa"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "CUSTOMER_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "zero_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('zero_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Zero Count", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "ebe05ff1e075656c1f06a8985d69d0bf"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "a7ed787e6e0ae0d05d08a4366bc20a4d"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "2c49886afcbab5fcd2e63d4c1f066740"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "97c3ee93ec89d677ce1dbe777a08670c"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "f450e8d4498279bc2d33944fe6c39860"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "2e7f7fe4952a1cdd682967eb5ed13793"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "54172084a64ec150a1be4bd34ffda7d9"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "6699d470eb38581cf787d82b6752c056"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "9e147670ecae6a0ffb025e407e334381"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "414840c373cd1c3065c884556e83a29b"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "93c71bc4c04cf107b11d250b398622af"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "042c1405f6dccc94abdd5c541d4becf1"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "14c4bf2684e0be03bb6a1c2fc71ab8c5"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.relationships_customers_customer_id__customer_id__ref_stg_signups_.b26bf8bd36", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "customers", "column_name": "customer_id", "test_name": "relationships", "test_display_name": "Relationships", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "fail", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "dbt_test", "test_sub_type": "relationships", "test_query": "with child as (\n    select customer_id as from_field\n    from elementary_tests.jaffle_shop_online.customers\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from elementary_tests.jaffle_shop_online.stg_signups\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null", "test_params": "{\"to\": \"ref('stg_signups')\", \"field\": \"customer_id\", \"column_name\": \"customer_id\", \"model\": \"{{ get_where_subquery(ref('customers')) }}\"}", "test_results": {"display_name": "Relationships - failed results sample", "results_sample": [{"from_field": 2001.0}, {"from_field": 2002.0}], "error_message": "Got 2 results, configured to fail if != 0", "failed_rows_count": 2}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "CUSTOMER_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "max", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('max' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Max", "metrics": [{"value": 1224.0, "min_value": 200.946863214, "max_value": 2878.053136786, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "aa1659303b97f0b0e6d7f437d78d84fb"}, {"value": 1819.0, "min_value": 569.547200191, "max_value": 2695.786133143, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "931eb18cff087c6aba2b0b59b00f8e50"}, {"value": 1358.0, "min_value": 603.153498211, "max_value": 2524.846501789, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "8279bab0cd0be00db9c57b1402090d98"}, {"value": 1884.0, "min_value": 691.656313099, "max_value": 2564.343686901, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "682250da5128102f9970534376ae4301"}, {"value": 1798.0, "min_value": 793.349208335, "max_value": 2519.317458332, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "a5a64f76249a63cea78bdfeeca953ad4"}, {"value": 1540.0, "min_value": 840.953906841, "max_value": 2438.474664587, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "5c91b317a17395c11713c7cacf90bbb5"}, {"value": 1018.0, "min_value": 571.183453625, "max_value": 2552.816546375, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "89dc3500d61568ce6916940192fdd716"}, {"value": 2138.0, "min_value": 534.771907436, "max_value": 2717.228092564, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "da154d482f2cf0feb89d402852e148c0"}, {"value": 2176.0, "min_value": 527.43162318, "max_value": 2834.56837682, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "ea15748d7bef0751ac95f27c3a25be34"}, {"value": 2156.0, "min_value": 548.490416186, "max_value": 2899.873220178, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "326797bcdd8555ed91cd40fdbaf88f00"}, {"value": 2170.0, "min_value": 575.729459582, "max_value": 2946.937207085, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "717b0a93fba7fb2e26930b0b949d9afc"}, {"value": 2184.0, "min_value": 605.487088062, "max_value": 2982.20521963, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "7d466e29bcb1ca57ec45585627919cc6"}, {"value": 2146.0, "min_value": 642.866961999, "max_value": 2995.133038001, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "bf51496c1430ff08a20498fff6cbb7b8"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "CUSTOMER_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "null_percent", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('null_percent' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Percent", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "9024fd5bc69f717d4e7fbd528ffdb6a6"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "2737e41c9392859e1c30d41565f62665"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "a1cbdb8aaca85e3579f9423d625e5c6c"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "e820bea09bf57c76dad9f1ff34ea0a5f"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "dfacd9582a3a46e24eae4dcd770d3499"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "c7a8a1e8b222a86a4170b59924dab027"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "6960ddd94c892220dc88459fe79a2800"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "0486c822cfc770faae30ca3035862236"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "d6686b226ec68f381208e8a13e8df856"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "d4e9a034d8e95fcd1c4cc04af56119ea"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "008801b47e08048ee6c410599d59baf5"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "0debbc2d68c62c74b6b4dc288d1108ef"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "d728bd7edd1b893e5466d3c132a835a8"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "CUSTOMER_LIFETIME_VALUE", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "average", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('average' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_LIFETIME_VALUE' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Average", "metrics": [{"value": 48.833333333, "min_value": 8.758905657, "max_value": 73.619882222, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "5dfb8ffe56ddc5af9843f2cb2d298136"}, {"value": 56.142857143, "min_value": 11.580725263, "max_value": 80.767038085, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "4a877bce27d79277c826377b7ef5312c"}, {"value": 9.0, "min_value": -25.626070868, "max_value": 99.386893378, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "ba06b65de7d7021c0b7931205d864ff4"}, {"value": 34.666666667, "min_value": -17.775956133, "max_value": 90.651280809, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "5e787a69c11d87d6559be565b3011bf3"}, {"value": 50.0, "min_value": -12.558153983, "max_value": 89.954257879, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "c1008c8e847b66284882d9b978bfb110"}, {"value": 19.5, "min_value": -15.650745, "max_value": 87.561691197, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "004c525ca743256a16b784350a11b661"}, {"value": 29.666666667, "min_value": -13.072073333, "max_value": 83.410817922, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "3128b409e416f7de13418eca8f3a24eb"}, {"value": 30.0, "min_value": -10.825866021, "max_value": 80.015861211, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "4b0f1a54e950a5d829b33ab325c28545"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "FIRST_NAME", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "null_percent", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('null_percent' as \n    varchar\n)\n                and upper(column_name) = upper(cast('FIRST_NAME' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Percent", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "49aaf9ef5b7f704eb9d473864b750b5b"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "13cfab56f3eeab48d47c2a925ebc41e8"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "507c7ab86e2a33ad2ce48e30a3b560d4"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "724deaa8ab1549fc3e995bbda4b73ffe"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "33a79368fbb9a39167deda2be44c396b"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "3a87609e84fef2d464d7a99152c6c445"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "eee339b58e85e44ee0fe749503df9ac6"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "7b4cbf57ed9b6817bd9f4ea166d777fa"}, {"value": 60.0, "min_value": -50.920997883, "max_value": 62.920997883, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "fb4f9f5b38ab405b50703c64858526a2"}, {"value": 33.333, "min_value": -50.90590347, "max_value": 67.875539833, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "63c328c2ba7a1143e39ee11caeeb98c3"}, {"value": 42.857, "min_value": -52.62491542, "max_value": 75.323248753, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "040c1cb3560167def814d17b41228c22"}, {"value": 33.333, "min_value": -50.883246058, "max_value": 76.963707597, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "473cf1971eb040dee842b41889fecc90"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "CUSTOMER_LIFETIME_VALUE", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "variance", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('variance' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_LIFETIME_VALUE' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Variance", "metrics": [{"value": 769.766666667, "min_value": -61.438127486, "max_value": 1283.877521426, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "c6fc49a41362224ba0ffd4ce9ef2c689"}, {"value": 954.142857143, "min_value": -35.408293628, "max_value": 1486.463127683, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "6ab5af794adf2c7a9b04fdd789bfc140"}, {"value": 239.0, "min_value": -354.546153812, "max_value": 1562.337279353, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "ec56e0bd47f6327e5f91f39972d99edc"}, {"value": 40.5, "min_value": -631.416215144, "max_value": 1613.849115576, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "7ebd51eb445eb65bd00f162292476438"}, {"value": 849.333333333, "min_value": -544.823113725, "max_value": 1646.62830853, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "f3980f054129167070959c6f059775c1"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "SIGNUP_DATE", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "null_percent", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('null_percent' as \n    varchar\n)\n                and upper(column_name) = upper(cast('SIGNUP_DATE' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Percent", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "68c93531cb86f32f81fbef99cfcdca62"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "9276dd5b0a4e9e88078a09fc0a4f7cf8"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "4de58c78c9a28ca2096f587c231c4121"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "8730b34d4ac5f118e94cc935949993cf"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "2cd9b39dad6848c1a390b8c7a7d91ce8"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "bc30dda083b909b9abf133d1291bb0eb"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "a42a71aa3e99501223c126199f6b229e"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "7d185857f12e979780e61d115b58cead"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "2caaed2b2e07de341a23a589bb135c95"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "fa25f3d012f930262d65171f2ae81844"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "f8d1c6e616ca9c77c49ce8db5642b020"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "3e9f536fc4c2e7cd150a8e239d2be8cc"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "FIRST_NAME", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "missing_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('missing_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('FIRST_NAME' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Missing Count", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "d1abda1f6e7df639eaadcc52d236af66"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "5d07a25d67ac7bdcaab10046fdad58bc"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "0255c42ef664506620a6deffe095090f"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "6a0631e4e0cdad6c756f1ebf9a3ca9b8"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "db4a3f5cde897204345ba7ca12de5012"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "c771aa192aa1f91324cf0b50128e44a5"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "0d09f6d1d8ac125b6da00ce0adca25b7"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "8d479fa30aa3cd9dea4a2f3d3a23996e"}, {"value": 6.0, "min_value": -5.092099788, "max_value": 6.292099788, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "0a099f32a7dd212cd300a7b4582d0986"}, {"value": 2.0, "min_value": -4.819224939, "max_value": 6.273770394, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "2872d43b7f6328564f56b83a4c87a9fa"}, {"value": 3.0, "min_value": -4.726108279, "max_value": 6.559441613, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "ee95ea875b7804272af443d797042b79"}, {"value": 1.0, "min_value": -4.479913702, "max_value": 6.326067548, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "d79f152c9e77bde44bdad3c6c0884728"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "LAST_NAME", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "null_percent", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('null_percent' as \n    varchar\n)\n                and upper(column_name) = upper(cast('LAST_NAME' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Percent", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "9704a7d470de1cb7862eab1f17aaa52f"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "1cfa8d13f0dfa6c9d943e4f41546f2d7"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "330dfa1729829c4ad2eabbdc69ecfe8e"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "2e49e8fc81fd2dccad7d65bead202cf1"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "a6960bbe6a83b364f93afe4c70b9ad1a"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "c38713186f86fea0019042452429a649"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "9ada5a84831af0ac8a11375577767574"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "fbdaa77139750cef4d475c97c325e59e"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "3aca500a2f44caa34a3a96052a87f826"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "14aab1520e3f2ac1d04cfc97ea7cf840"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "5dc48ff8134363144c628b246c6c3b32"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "31b568fd1655990682d1014cc8fbabdc"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "CUSTOMER_EMAIL", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "missing_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('missing_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_EMAIL' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Missing Count", "metrics": [{"value": 0.0, "min_value": -1.621320344, "max_value": 2.621320344, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "a411f978367784b00da585d8283b1e2b"}, {"value": 0.0, "min_value": -1.398717474, "max_value": 2.065384141, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "bbbecdfc5927fc4b38ac59bb51af3c21"}, {"value": 0.0, "min_value": -1.25, "max_value": 1.75, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "74215c3c5b13da13844de06ee89593ea"}, {"value": 2.0, "min_value": -2.083281573, "max_value": 3.283281573, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "1161a08f84aa8136fcaddb6ba92ea717"}, {"value": 0.0, "min_value": -2.00998008, "max_value": 3.00998008, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "24df9c2a867a213c397e24c9b7833597"}, {"value": 0.0, "min_value": -1.931815949, "max_value": 2.788958806, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "93abcd2a95ac7976df5d0d14221fc54f"}, {"value": 0.0, "min_value": -1.857071427, "max_value": 2.607071427, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "97c54412f277cb25158057476f94beb1"}, {"value": 0.0, "min_value": -1.78798701, "max_value": 2.454653677, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "baca2e9c455ea2d407003a2c04dedd1e"}, {"value": 10.0, "min_value": -8.086160024, "max_value": 10.686160024, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "c4576de89f537e513f10b26c43d00aed"}, {"value": 6.0, "min_value": -8.140028645, "max_value": 11.594574099, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "24a18380543b8a00fd30abf252dfed4b"}, {"value": 7.0, "min_value": -8.291040365, "max_value": 12.624373698, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "0c87c0901334ad31d7abf8f5b9a2f336"}, {"value": 3.0, "min_value": -7.805702721, "max_value": 12.267241182, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "5975fa3c7776d048381e3f107570f6e7"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "CUSTOMER_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "zero_percent", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('zero_percent' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Zero Percent", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "bc44920626423e65e12c77e86ac74e0f"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "fa4a3f780973b4f8eb234d08dabbe06e"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "e5d5c86ef9d8d6245fc9363a76ee2b07"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "9288eac503d80d87e452920fb46fb4c6"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "6c13738bad5a416c385efeabef33dc26"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "f3aa6047a8256f94b4792daf6e23ded9"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "784f3617bdc5d9907b1ecd8c51113ba0"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "14abeec97674cab9f65de6d9e0edcaed"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "3d8e43f0acaf081656a6d990ef80f0d9"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "b58c171273179d1879b1fe6dafa03afe"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "dbc8696439648890ccee3f6052dbaa37"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "b61316b91e8d3534c1891a5e4e59bf61"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "fa89871e79bc90d565f5bda712386ea2"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "CUSTOMER_EMAIL", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "min_length", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('min_length' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_EMAIL' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Min Length", "metrics": [{"value": 21.0, "min_value": 21.0, "max_value": 21.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "10c76f75a19d1b63e39a67f0ac5cdc38"}, {"value": 22.0, "min_value": 19.601282526, "max_value": 23.065384141, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "e78671b1c9b2fc277e26d0ebbfb55024"}, {"value": 21.0, "min_value": 19.75, "max_value": 22.75, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "2de31f1d562bde4268a269f2f29f5624"}, {"value": 21.0, "min_value": 19.858359214, "max_value": 22.541640786, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "652957a7b910875ad0b8360c84ef41d4"}, {"value": 22.0, "min_value": 19.784139995, "max_value": 22.882526672, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "ba03141b4c3ffba93a6b7ab96eec25f7"}, {"value": 22.0, "min_value": 19.825003977, "max_value": 23.03213888, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "fb476d82a74ab17544b6df07bf52393d"}, {"value": 23.0, "min_value": 19.392928573, "max_value": 23.857071427, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "df06d329124115626204a813438f754c"}, {"value": 23.0, "min_value": 19.277777778, "max_value": 24.277777778, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "d78614cb579a0fdf18c6ae50ff7311ad"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "NUMBER_OF_ORDERS", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "min", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('min' as \n    varchar\n)\n                and upper(column_name) = upper(cast('NUMBER_OF_ORDERS' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Min", "metrics": [{"value": 1.0, "min_value": 1.0, "max_value": 1.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "4b4eb59f13a632c7ead5f6cf07592c6a"}, {"value": 1.0, "min_value": 1.0, "max_value": 1.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "2402e01fddd1b534d597e4bdc4a761d4"}, {"value": 1.0, "min_value": 1.0, "max_value": 1.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "3f8c25e4d61ee155a805bc26194fa862"}, {"value": 1.0, "min_value": 1.0, "max_value": 1.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "526d75ad6ba36a80bca5e4078667e13c"}, {"value": 2.0, "min_value": -0.05807820472, "max_value": 2.391411538, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "a540a56a09d7f9ed51cfc94051ade54a"}, {"value": 1.0, "min_value": 0.008963723829, "max_value": 2.276750562, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "b19f61976f58c5de7a9d6530613f1188"}, {"value": 1.0, "min_value": 0.06433982822, "max_value": 2.185660172, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "1213e6b9b564d45aaf922fdcd4297b78"}, {"value": 2.0, "min_value": -0.1006534333, "max_value": 2.545097878, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "2b261a2dd219c3760bd2fba9c6c86ce7"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "CUSTOMER_LIFETIME_VALUE", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "zero_percent", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('zero_percent' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_LIFETIME_VALUE' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Zero Percent", "metrics": [{"value": 0.0, "min_value": -13.510462423, "max_value": 21.843462423, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "ce8d34fbe8a3d7e712d5b256a5e85c0c"}, {"value": 0.0, "min_value": -11.655512713, "max_value": 17.210846046, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "724293c41547965444e03b0a476c96de"}, {"value": 50.0, "min_value": -57.223870122, "max_value": 86.390370122, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "efabdefa8ada1722c0721f50ee0bd631"}, {"value": 18.182, "min_value": -47.0709423, "max_value": 77.6769423, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "75a720944a47c9d00a5dcf4cc342d962"}, {"value": 50.0, "min_value": -49.044257611, "max_value": 91.215924278, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "c8cfeac737ab980c0ec86792c9f5f354"}, {"value": 0.0, "min_value": -50.265064683, "max_value": 86.41220754, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "629f3a58b5d331b89bd9b19e65326855"}, {"value": 0.0, "min_value": -50.295290642, "max_value": 81.924040642, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "a0f7f8bdb7e565f75c634d046e7bec6c"}, {"value": 100.0, "min_value": -79.28929617, "max_value": 129.625962837, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "cbe76c52ba5882282ae94811b9fa7d2e"}, {"value": 92.308, "min_value": -85.403591496, "max_value": 149.168191496, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "b1f13bf21fc898638f9b5388529df9ee"}, {"value": 100.0, "min_value": -89.113086791, "max_value": 165.262723155, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "d517ff5237e44920c5c19df838648180"}, {"value": 100.0, "min_value": -89.362617423, "max_value": 175.833117423, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "fd6b85d0e4bc1df35a385a9ac4220d56"}, {"value": 100.0, "min_value": -87.852248529, "max_value": 183.05578699, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "3d22167cd2a0ef48dd077a6673ba89ac"}, {"value": 100.0, "min_value": -85.408688736, "max_value": 188.097688736, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "2036ec8c0a1a8bc842a5c3ee55451dc6"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "LAST_NAME", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "null_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('null_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('LAST_NAME' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Count", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "c4458ffb8c8ee22335ce93afb05c1840"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "a77ab6285616d36de55ab667569eae91"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "b52e091b05d77d34f4bf7b633b3f6ecc"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "757fa3b1860076c59a4d75a29f9e835e"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "b44b545a308d57c8a70a6e154fdeb108"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "e796b813cc5cbc398f9821b9f640df59"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "a132176dc54a5f1b53339fd483ca9d41"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "2b9e155e22395eb7356629c61e81501e"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "a72706d905acdc32c26a901796447085"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "6b9cd5b72f01bdca57759081696fa7c4"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "6baaa9dac45a12a741b0199ced9766d6"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "9921562132cbc0dcd3d4fc618810908f"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "NUMBER_OF_ORDERS", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "average", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('average' as \n    varchar\n)\n                and upper(column_name) = upper(cast('NUMBER_OF_ORDERS' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Average", "metrics": [{"value": 2.333333333, "min_value": 1.459559885, "max_value": 2.873773448, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "9c806a5fd6e17274fde96341440102dc"}, {"value": 2.857142857, "min_value": 1.100572293, "max_value": 3.693078501, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "d94aa5e1a4e6a2f0e77b0129e8d7494e"}, {"value": 1.0, "min_value": -0.2997633417, "max_value": 4.395001437, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "55ccfccc61b90668a555c9d0c6159539"}, {"value": 1.555555556, "min_value": -0.1881941106, "max_value": 4.086606809, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "ca5a6027c8cc761d016170c9bc238f06"}, {"value": 2.0, "min_value": 0.04491097602, "max_value": 3.870432939, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "b8fdb082d69ed6a2c34d866f538c2f6e"}, {"value": 1.5, "min_value": 0.07070050955, "max_value": 3.713879989, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "4e01e03d8801a8622700a8ee87315743"}, {"value": 1.666666667, "min_value": 0.1607284416, "max_value": 3.567446162, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "4035fd54548155ea0071b79328f32eb0"}, {"value": 2.0, "min_value": 0.2800562159, "max_value": 3.478321209, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "aba2a2837cd1ef2e8e888111b750ace7"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "NUMBER_OF_ORDERS", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "variance", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('variance' as \n    varchar\n)\n                and upper(column_name) = upper(cast('NUMBER_OF_ORDERS' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Variance", "metrics": [{"value": 1.066666667, "min_value": -0.680880229, "max_value": 2.147546896, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "a912b72240e57d9ad4c0c7760b345971"}, {"value": 1.80952381, "min_value": -1.023251573, "max_value": 3.207378557, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "a5f83c8e257401e034fedd0bdd0ca54f"}, {"value": 0.5277777778, "min_value": -0.9724111379, "max_value": 2.874395265, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "bf3107c7d9731c8970c42c15cacf435d"}, {"value": 0.5, "min_value": -0.9114136793, "max_value": 2.633000981, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "2e429f3895b625bfb4f699a27fdab431"}, {"value": 1.333333333, "min_value": -0.7479080858, "max_value": 2.627008615, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "e0bd660b521d84f6d4d7f916128916a1"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "NUMBER_OF_ORDERS", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "zero_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('zero_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('NUMBER_OF_ORDERS' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Zero Count", "metrics": [{"value": 0.0, "min_value": -1.621320344, "max_value": 2.621320344, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "b8a88f5755a68541c8c5d659b59093aa"}, {"value": 0.0, "min_value": -1.398717474, "max_value": 2.065384141, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "fc883d688ce38f3b36313645010dfc44"}, {"value": 1.0, "min_value": -1.232050808, "max_value": 2.232050808, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "3f2ed2344ac7aa66e50054257a1596de"}, {"value": 2.0, "min_value": -1.70998008, "max_value": 3.30998008, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "1d4b605dc31194e937b25238b9c2decb"}, {"value": 1.0, "min_value": -1.424984625, "max_value": 3.091651291, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "038462329c345275172e685e92771b13"}, {"value": 0.0, "min_value": -1.553501124, "max_value": 2.982072552, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "e6c9a384f3449e2bcd844dc17d42ff50"}, {"value": 0.0, "min_value": -1.607071427, "max_value": 2.857071427, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "d1374386add8c69858d703b2d37b6fa1"}, {"value": 11.0, "min_value": -8.805227466, "max_value": 12.360783022, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "bd496fcb70d6e9e0bcd006ee9c222986"}, {"value": 12.0, "min_value": -11.114021705, "max_value": 16.714021705, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "b04f89a538e8847843dbeeee3a23143d"}, {"value": 10.0, "min_value": -11.264644246, "max_value": 18.173735156, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "d6f43cd3ba7a225322a590b9c86d6e3f"}, {"value": 6.0, "min_value": -10.539605956, "max_value": 17.872939289, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "de9c4070a34f3f8d333f2b072339389d"}, {"value": 7.0, "min_value": -9.958288561, "max_value": 17.804442407, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "51c8ad96e73f4ffc001b66735a120c5f"}, {"value": 3.0, "min_value": -9.500161602, "max_value": 17.214447316, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "98f058949ccc3aff6ae826f8cfd904b1"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "MOST_RECENT_ORDER", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "null_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('null_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('MOST_RECENT_ORDER' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Count", "metrics": [{"value": 0.0, "min_value": -1.621320344, "max_value": 2.621320344, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "efc4b95dae5ad9f1a61f332481cb70f8"}, {"value": 0.0, "min_value": -1.398717474, "max_value": 2.065384141, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "5afc2f1537cf07f95fb91bd26af35e81"}, {"value": 1.0, "min_value": -1.232050808, "max_value": 2.232050808, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "3dd69a83e88d0d99b7e240f5d5bd4c21"}, {"value": 2.0, "min_value": -1.70998008, "max_value": 3.30998008, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "cc88b233fe717e7648f3e3d198d74a55"}, {"value": 1.0, "min_value": -1.424984625, "max_value": 3.091651291, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "dc06a752109e45e8c54e502268813987"}, {"value": 0.0, "min_value": -1.553501124, "max_value": 2.982072552, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "b55037a18751cbec39265258d767dee0"}, {"value": 0.0, "min_value": -1.607071427, "max_value": 2.857071427, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "5774c94ee6cb59094eeeab4f4d201d09"}, {"value": 0.0, "min_value": -1.623893916, "max_value": 2.735005027, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "cd9d1f1252d2e060882da97e6f7ffae0"}, {"value": 10.0, "min_value": -7.692388155, "max_value": 10.692388155, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "23dd8b278a024c93eb276ac8d3f137f2"}, {"value": 6.0, "min_value": -7.714743141, "max_value": 11.532924959, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "429ae1e1e8a117790b2643a3d5320d8f"}, {"value": 7.0, "min_value": -7.846861342, "max_value": 12.513528009, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "5f5770d5c283984d630c846f11837199"}, {"value": 3.0, "min_value": -7.377950482, "max_value": 12.147181252, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "2466382d4b84fb5c77454c85d2279026"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "FIRST_ORDER", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "null_percent", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('null_percent' as \n    varchar\n)\n                and upper(column_name) = upper(cast('FIRST_ORDER' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Percent", "metrics": [{"value": 0.0, "min_value": -13.510462423, "max_value": 21.843462423, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "385cc374e409d487d4153e68ccc6df3d"}, {"value": 0.0, "min_value": -11.655512713, "max_value": 17.210846046, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "542afa56d2931478d96a4d9ee28e05c0"}, {"value": 50.0, "min_value": -57.223870122, "max_value": 86.390370122, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "d2ad5b3369e419bf31e4460888ba2bcd"}, {"value": 18.182, "min_value": -47.0709423, "max_value": 77.6769423, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "fb23616505ddb977b0811fad1a127595"}, {"value": 50.0, "min_value": -49.044257611, "max_value": 91.215924278, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "7c4ee1d0d6ca5f8b4e5ad1d47638a4b6"}, {"value": 0.0, "min_value": -50.265064683, "max_value": 86.41220754, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "6bdbd53415da12aa7a4de2013fc1726b"}, {"value": 0.0, "min_value": -50.295290642, "max_value": 81.924040642, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "01eb6967c25c1d1fd70b5f963599044f"}, {"value": 0.0, "min_value": -49.772797059, "max_value": 77.887241504, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "7af91c731f2ea46224f0c4fd3c7c2e58"}, {"value": 100.0, "min_value": -78.685164098, "max_value": 123.988164098, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "bb19852eec3578cb5d9314906724ce3a"}, {"value": 100.0, "min_value": -89.216851451, "max_value": 148.583215088, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "20916c4a3623242f01257008f9d09b6b"}, {"value": 100.0, "min_value": -93.1441358, "max_value": 164.229969133, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "475b8c6064c67ddc31b19e4567ed80ed"}, {"value": 100.0, "min_value": -93.873952653, "max_value": 174.876260346, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "6a6293056f98e45e11bb6e2fe3ddb4c3"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "CUSTOMER_LIFETIME_VALUE", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "null_percent", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('null_percent' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_LIFETIME_VALUE' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Percent", "metrics": [{"value": 0.0, "min_value": -13.510462423, "max_value": 21.843462423, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "1b93bb3d949e7a4e94cbff5fc824fa56"}, {"value": 0.0, "min_value": -11.655512713, "max_value": 17.210846046, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "a2fac890dfd9c902b0e9d8ff487ee05b"}, {"value": 50.0, "min_value": -57.223870122, "max_value": 86.390370122, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "3a0d898dfe5bd47380fb6ab0f5d8d093"}, {"value": 18.182, "min_value": -47.0709423, "max_value": 77.6769423, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "2706dba80c4670c7f47f86b1c7f8ee3d"}, {"value": 50.0, "min_value": -49.044257611, "max_value": 91.215924278, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "84b9f4d2fcd2224fe49ce31653d1a793"}, {"value": 0.0, "min_value": -50.265064683, "max_value": 86.41220754, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "f2363b96a5983c129b606d2d6a7b44e2"}, {"value": 0.0, "min_value": -50.295290642, "max_value": 81.924040642, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "e6e0020f2b9a11c1ad7aba0c93e79148"}, {"value": 100.0, "min_value": -79.28929617, "max_value": 129.625962837, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "d2178f5583c94850a673e0c05a507d62"}, {"value": 92.308, "min_value": -85.403591496, "max_value": 149.168191496, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "bc6f2c9ba3f8581da321f3c5ff457fc3"}, {"value": 100.0, "min_value": -89.113086791, "max_value": 165.262723155, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "656d66e4a0a85f72d9f919ac9eea71fc"}, {"value": 100.0, "min_value": -89.362617423, "max_value": 175.833117423, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "d3fac8164a8ecd4e8dc2138d6d8f326d"}, {"value": 100.0, "min_value": -87.852248529, "max_value": 183.05578699, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "14737eecf21ea15c317cf796df23a2d5"}, {"value": 100.0, "min_value": -85.408688736, "max_value": 188.097688736, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "d1df06a36fdabb27f21f67faed3338f1"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "SIGNUP_DATE", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "null_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('null_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('SIGNUP_DATE' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Count", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "17c1c872ddaac9e6b961117fc54e1ff7"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "9b33955a5212a76d4d76210b84aaec6f"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "27301fddee9504510e71e4034ac631b2"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "dad817359272df66e8f234967933c3f0"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "e2da974e80b477ff926627df6ca26e4a"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "a13dc2ec458e11cb3b3fd2c5aa0ccbe7"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "f5ad3788192da98269e7bc7d299cad28"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "47254a43b0bf38611252ebc71fc234b4"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "42dbdf04eed88baf8bfa0297d35bec50"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "0eda9a192caa315d6ebbbbad5103c76d"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "64dac6879a6e5af02d5319f4a311b7a8"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "efb049e2357e74f7beacf426cc56e064"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "NUMBER_OF_ORDERS", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "standard_deviation", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('standard_deviation' as \n    varchar\n)\n                and upper(column_name) = upper(cast('NUMBER_OF_ORDERS' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Standard Deviation", "metrics": [{"value": 1.032795559, "min_value": -0.01662389801, "max_value": 1.681874989, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "ff7fb174dbeac2e05705d021e872acd2"}, {"value": 1.345185418, "min_value": -0.06832579975, "max_value": 2.075283473, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "c90defe31616d63c8c1a225d03880c41"}, {"value": 0.7264831573, "min_value": -0.03452098851, "max_value": 1.902980822, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "703fcbc93f76526d99a14bffad13502d"}, {"value": 0.7071067812, "min_value": -0.003781731843, "max_value": 1.781392311, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "850a5a0ad3054263fd1a9da47c55d196"}, {"value": 1.154700538, "min_value": 0.07090326983, "max_value": 1.795339059, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "517c6d4e26ba5179016cad2e4e3a42fe"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "CUSTOMER_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "standard_deviation", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('standard_deviation' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Standard Deviation", "metrics": [{"value": 402.549872687, "min_value": 213.471779128, "max_value": 708.247790519, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "96c2630d2f2f7d86ddf238d0cd788396"}, {"value": 679.623285007, "min_value": 116.440778889, "max_value": 951.121124214, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "dce1091daf67376a3fd8a4ae89be1638"}, {"value": 669.630121784, "min_value": 170.705517295, "max_value": 964.780970924, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "1f63ca2e4887686d8b6014028f546083"}, {"value": 625.387298182, "min_value": 226.837204304, "max_value": 931.706905544, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "dcdc0a9c052e5a7b0b4940f8c2b3ac91"}, {"value": 1214.809450078, "min_value": -154.584737294, "max_value": 1524.974645527, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "06b66635b3f2e401429e2d8269423c18"}, {"value": 1079.044948091, "min_value": -145.743557844, "max_value": 1628.662035784, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "7b7f7e874b34d35e0751b14fc8ddc7ae"}, {"value": 457.98071284, "min_value": -168.668045604, "max_value": 1580.716892011, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "d738b76b4e7df285260d33b7375ebd91"}, {"value": 26.110603907, "min_value": -433.35136091, "max_value": 1694.308247473, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "14901d31577cea69ee6fd73c96a02c9d"}, {"value": 100.22922446, "min_value": -544.613079623, "max_value": 1699.520122423, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "ed3e50a80661d92c6a773ec19d8d34b7"}, {"value": 52.903371033, "min_value": -635.674908904, "max_value": 1695.209197091, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "9f297703cd010e0de15cfa2c54a2fe93"}, {"value": 60.311414066, "min_value": -692.599258513, "max_value": 1673.890925029, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "b081fcbc360b09e38917c12d35e60962"}, {"value": 39.406912616, "min_value": -737.531169239, "max_value": 1649.401463348, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "66a3fe8d883264dcd479a4820396cdf0"}, {"value": 66.017674401, "min_value": -760.416309808, "max_value": 1616.584107824, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "0d07741df5798e055b00257acaa363ce"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "LAST_NAME", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "min_length", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('min_length' as \n    varchar\n)\n                and upper(column_name) = upper(cast('LAST_NAME' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Min Length", "metrics": [{"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "964bfddafa239cff7e6d3278a47f1026"}, {"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "7f1f5420485271dae393677751eee574"}, {"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "3b247053877aff53bfde6de799b7e419"}, {"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "753dbe16bf0a6f32549610ad65630284"}, {"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "75adb0f1ace2aad9395156fbe3458c56"}, {"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "374af5a3568304271ac868b73e14534f"}, {"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "7425e0504c1fdfb8753cdc2cd4ff2b16"}, {"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "7ebd77ceb0a96b69d91ff7df9425f8d2"}, {"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "885b0f6f5c05baf4050d439550581230"}, {"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "7aabfe861ea78d6d3ca0e74d437de788"}, {"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "fb56770551829c9b42c58f14d6650370"}, {"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "d8040ff73d3a867e056255ead1f1fb1b"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "FIRST_NAME", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "missing_percent", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('missing_percent' as \n    varchar\n)\n                and upper(column_name) = upper(cast('FIRST_NAME' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Missing Percent", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "0fb3618576db8e3c18606d924d91fea5"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "fea5213e04369a7cc5ff9241f2ed0eb1"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "9c7f867e8bc8f46866586bd1c0b7e30f"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "0425a1c99324371fbf62d2668410dfdb"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "7890136cae464bf0c8e361b4490250e7"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "6448b729e2a6cff1e056793acdb9a91d"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "878162141d0589d86f2ffbb5ea9f2cc4"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "ef881c6fcb85ff2fa3ef172cff1f7cd5"}, {"value": 60.0, "min_value": -50.920997883, "max_value": 62.920997883, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "af011d674e68974006c0665578bf4641"}, {"value": 33.333, "min_value": -50.90590347, "max_value": 67.875539833, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "3a26dde94f499223d809dfa989c5b104"}, {"value": 42.857, "min_value": -52.62491542, "max_value": 75.323248753, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "512ea210e58ea05ba3852a6a52698152"}, {"value": 33.333, "min_value": -50.883246058, "max_value": 76.963707597, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "8e8b217daac67fcc94b69642712a525e"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "FIRST_NAME", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "null_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('null_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('FIRST_NAME' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Count", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "8fc2d970ff7a370c3acb1639f8cfc8b7"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "3215969653bddbc060bcaaf5ff0b1e74"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "eb2ea144b8005da3bd1c1c380ebd6046"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "98a15951b545037e9ab23e4bc3bccb9b"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "a14c5b2281dbe9143342fd6b9390f5cd"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "c4f04b9aee754ef721f11d2e5970b3a6"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "78a3b40577ed2ecc35e9ddec4822d76d"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "b679a372f8006ac663113f69e1305af6"}, {"value": 6.0, "min_value": -5.092099788, "max_value": 6.292099788, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "00fa823273296ed1dd87f9e38259ac77"}, {"value": 2.0, "min_value": -4.819224939, "max_value": 6.273770394, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "af6e3d65e1580bd2df6b07de902c42ca"}, {"value": 3.0, "min_value": -4.726108279, "max_value": 6.559441613, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "2e0ad134534bca2ec80a604c99563eea"}, {"value": 1.0, "min_value": -4.479913702, "max_value": 6.326067548, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "cdc584406c89c6b54d10a5f55eb8db4d"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.not_null_customers_signup_date.626cab0792", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "customers", "column_name": "signup_date", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "fail", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "dbt_test", "test_sub_type": "not_null", "test_query": "select signup_date\nfrom elementary_tests.jaffle_shop_online.customers\nwhere signup_date is null", "test_params": "{\"column_name\": \"signup_date\", \"model\": \"{{ get_where_subquery(ref('customers')) }}\"}", "test_results": {"display_name": "Not Null - failed results sample", "results_sample": [{"signup_date": null}, {"signup_date": null}], "error_message": "Got 2 results, configured to fail if != 0", "failed_rows_count": 2}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "CUSTOMER_LIFETIME_VALUE", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "standard_deviation", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('standard_deviation' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_LIFETIME_VALUE' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Standard Deviation", "metrics": [{"value": 27.744669158, "min_value": 10.788495469, "max_value": 38.232280646, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "24bbe94110fd141ec61cdff97dfa0711"}, {"value": 30.889202922, "min_value": 11.93247642, "max_value": 41.340842938, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "7d9b56bd65c7930f5e946a492c37025b"}, {"value": 15.459624834, "min_value": 3.221398412, "max_value": 44.463403523, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "03b018a998225115a39989d1b5f36fd4"}, {"value": 6.363961031, "min_value": -9.12890173, "max_value": 49.82232769, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "95b9f15520b490a6b3ddab29a3c4ac4a"}, {"value": 29.143323993, "min_value": -6.66735439, "max_value": 50.292984021, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "acfbbbfdf89d833ea4d98ecab16c7050"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "CUSTOMER_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "average", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('average' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Average", "metrics": [{"value": 544.0, "min_value": 54.226146216, "max_value": 1335.857187117, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "6847f7eacc26e50f09113b351ac8a401"}, {"value": 933.857142857, "min_value": 161.115440194, "max_value": 1388.1782106, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "8576ae3db56141086fec55e1f5d3cc7c"}, {"value": 884.5, "min_value": 274.758676757, "max_value": 1329.461561338, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "4efdd73ea3479e93966f50a78e623b15"}, {"value": 1191.545454545, "min_value": 186.050183325, "max_value": 1573.94418897, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "b91c380f016300c3f15da6c7b98345f9"}, {"value": 939.0, "min_value": 264.953438655, "max_value": 1514.708538257, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "100f0ff1a1fe6e642eb25c618955d465"}, {"value": 777.0, "min_value": 289.108558715, "max_value": 1458.315992924, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "3600e01d5ff26ffd5dfc83b24bd3ccb1"}, {"value": 648.333333333, "min_value": 253.861312875, "max_value": 1437.218503143, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "84f91f1acc4945fcd62d4197a44ea184"}, {"value": 2091.818181818, "min_value": -379.631548609, "max_value": 2347.66209214, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "78ab8ee13fd83810bdd7c6d5d8b6ee7e"}, {"value": 2052.692307692, "min_value": -546.426237392, "max_value": 2728.192188107, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "52bae8f611897745bcb35f0dd62b353c"}, {"value": 2077.1, "min_value": -610.685819992, "max_value": 2971.763957007, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "4b00377aac34d58c6ef53ea702179d83"}, {"value": 2053.333333333, "min_value": -614.38258713, "max_value": 3120.926434949, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "4ab4991884b1d1778d827bacbc33e3fe"}, {"value": 2127.285714286, "min_value": -609.861369797, "max_value": 3250.868877674, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "0b807df8536b207f932827cccbe08b34"}, {"value": 2087.666666667, "min_value": -578.673504963, "max_value": 3329.275714658, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "7b04b27720a9c16587b853e6d7a510e8"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.unique_customers_customer_id.c5af1ff4b1", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "customers", "column_name": "customer_id", "test_name": "unique", "test_display_name": "Unique", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "dbt_test", "test_sub_type": "unique", "test_query": "select\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom elementary_tests.jaffle_shop_online.customers\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1", "test_params": "{\"column_name\": \"customer_id\", \"model\": \"{{ get_where_subquery(ref('customers')) }}\"}", "test_results": {"display_name": "Unique - failed results sample", "results_sample": "", "error_message": "No error message", "failed_rows_count": -1}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "MOST_RECENT_ORDER", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "null_percent", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('null_percent' as \n    varchar\n)\n                and upper(column_name) = upper(cast('MOST_RECENT_ORDER' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Percent", "metrics": [{"value": 0.0, "min_value": -13.510462423, "max_value": 21.843462423, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "a46ab7d13bba8111f37e6f2d429e0e2e"}, {"value": 0.0, "min_value": -11.655512713, "max_value": 17.210846046, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "1f9e805d56a0a849a77f190adb612508"}, {"value": 50.0, "min_value": -57.223870122, "max_value": 86.390370122, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "ba7b1716d41b671a6641806c4f741b52"}, {"value": 18.182, "min_value": -47.0709423, "max_value": 77.6769423, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "b615a49d8d4886750acbc45511538c51"}, {"value": 50.0, "min_value": -49.044257611, "max_value": 91.215924278, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "9bf546974bfed3131fc973f45066d49b"}, {"value": 0.0, "min_value": -50.265064683, "max_value": 86.41220754, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "1a3dfa6db576853df0a9e63946f29e19"}, {"value": 0.0, "min_value": -50.295290642, "max_value": 81.924040642, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "77ac21b7b786fec66d5ba682ce12cf92"}, {"value": 0.0, "min_value": -49.772797059, "max_value": 77.887241504, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "b3cb18611871618dafd873a3d40d4292"}, {"value": 100.0, "min_value": -78.685164098, "max_value": 123.988164098, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "c05aa2e10b62b826baf6ca98744d8ab9"}, {"value": 100.0, "min_value": -89.216851451, "max_value": 148.583215088, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "5a3087216eb201c1c4d72e5361fb8777"}, {"value": 100.0, "min_value": -93.1441358, "max_value": 164.229969133, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "74853516714cfb19363e7d958a1596d7"}, {"value": 100.0, "min_value": -93.873952653, "max_value": 174.876260346, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "9b8ead127c51fe98e656bd322610e127"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "CUSTOMER_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "min", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('min' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Min", "metrics": [{"value": 115.0, "min_value": -13.444696834, "max_value": 194.444696834, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "c1ad53e8d2192bb169b3b70a535e5a1b"}, {"value": 221.0, "min_value": -103.682561413, "max_value": 371.682561413, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "1e6fe757bb1a13088dde0c2a03099816"}, {"value": 411.0, "min_value": -255.337232705, "max_value": 661.837232705, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "a2e96b5c4410bcc53ff8f4a4b82e01ff"}, {"value": 107.0, "min_value": -233.614654915, "max_value": 601.614654915, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "5a68782a36f5a82961dc89c1e7fbd550"}, {"value": 80.0, "min_value": -227.979503972, "max_value": 561.312837306, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "8df5daade4e69f6500a58178d44c9685"}, {"value": 14.0, "min_value": -254.835596274, "max_value": 544.549881988, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "2f070b49d5fe7dbd808b4be0f4d5e38a"}, {"value": 136.0, "min_value": -226.412802021, "max_value": 513.912802021, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "12e2e7ed2e1d0eb6b8cb036bd2d7406c"}, {"value": 2058.0, "min_value": -1588.869411981, "max_value": 2301.75830087, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "537a53bf864cc0c7fbebeabc228ca139"}, {"value": 1770.0, "min_value": -1774.225439998, "max_value": 2769.825439998, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "a784c0d7ce822daf855d1c2ce6ba71a6"}, {"value": 2018.0, "min_value": -1920.699904173, "max_value": 3192.699904173, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "6844a475ee1cd216e126b6a7ddb7cabd"}, {"value": 2006.0, "min_value": -1960.947981659, "max_value": 3461.281314992, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "ac7406834cae14889f0398415452a4fc"}, {"value": 2070.0, "min_value": -1966.74752259, "max_value": 3670.132137975, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "e0d2d9edccb20ddb7d2b287fea497717"}, {"value": 2016.0, "min_value": -1929.409220838, "max_value": 3799.123506553, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "189c2f775e0a228385d72be3169c3e3a"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "CUSTOMER_LIFETIME_VALUE", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "zero_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('zero_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_LIFETIME_VALUE' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Zero Count", "metrics": [{"value": 0.0, "min_value": -1.621320344, "max_value": 2.621320344, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "bc8b4dbf0414363493515288beef20b1"}, {"value": 0.0, "min_value": -1.398717474, "max_value": 2.065384141, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "21ddafa4e73f4012c39020c5709a8de4"}, {"value": 1.0, "min_value": -1.232050808, "max_value": 2.232050808, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "950e202e4c00e775b51db3b8fa340338"}, {"value": 2.0, "min_value": -1.70998008, "max_value": 3.30998008, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "40411218c84673c324fc81771ccf15d4"}, {"value": 1.0, "min_value": -1.424984625, "max_value": 3.091651291, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "280a99ee6f43472a749e186f712f6aa2"}, {"value": 0.0, "min_value": -1.553501124, "max_value": 2.982072552, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "2c113d45af8f0539805fe6b2aa660453"}, {"value": 0.0, "min_value": -1.607071427, "max_value": 2.857071427, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "86a011066fbaae8bafe1b7acf0a1b64e"}, {"value": 11.0, "min_value": -8.805227466, "max_value": 12.360783022, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "e7bfce347f5eba1558fd76a4e9f6f6ed"}, {"value": 12.0, "min_value": -11.114021705, "max_value": 16.714021705, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "45645773f71c59adb23869b2f0d850f9"}, {"value": 10.0, "min_value": -11.264644246, "max_value": 18.173735156, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "a8428d9e785cfe294535dcc656b86de5"}, {"value": 6.0, "min_value": -10.539605956, "max_value": 17.872939289, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "de9572bb1fa89114f3f4c4c0299b0091"}, {"value": 7.0, "min_value": -9.958288561, "max_value": 17.804442407, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "e860eb631fbb5ac21dd904d9dbaec8d8"}, {"value": 3.0, "min_value": -9.500161602, "max_value": 17.214447316, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "a4be38134070de512a4831c64d1be30e"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "CUSTOMER_EMAIL", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "null_percent", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('null_percent' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_EMAIL' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Percent", "metrics": [{"value": 0.0, "min_value": -13.510462423, "max_value": 21.843462423, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "28f4a5438ef34a504e6b1d0da12a83fa"}, {"value": 0.0, "min_value": -11.655512713, "max_value": 17.210846046, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "8aef5663ff84ed68e0b226964e76c207"}, {"value": 0.0, "min_value": -10.41625, "max_value": 14.58275, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "8a416a494a5a06b960a09e8e69ea7e7f"}, {"value": 18.182, "min_value": -18.856546312, "max_value": 29.462546312, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "f6843f0aaeaa181c3b1efadb18673611"}, {"value": 0.0, "min_value": -18.144734944, "max_value": 26.983068277, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "8d404b36fe2dc86168e9e4c0735263b9"}, {"value": 0.0, "min_value": -17.410809591, "max_value": 24.986523877, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "a6e237839a84cdd184162e28f676f419"}, {"value": 0.0, "min_value": -16.718776948, "max_value": 23.347526948, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "e525935ceb63aee3fa904d0be2cdee24"}, {"value": 0.0, "min_value": -16.084032385, "max_value": 21.976254608, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "5d87e3fd0526c2f47e4a6bd58a57fa7d"}, {"value": 100.0, "min_value": -81.153721019, "max_value": 106.456721019, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "8848122a22457927269614575d0a4317"}, {"value": 100.0, "min_value": -98.411965939, "max_value": 139.596511394, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "b3a6f0bed35b9a0e2074c3e7e5d2e5a6"}, {"value": 100.0, "min_value": -105.469517644, "max_value": 159.888684311, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "aa32932bcc0041cf7067af78f904874b"}, {"value": 100.0, "min_value": -107.921105338, "max_value": 173.538797645, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "09c812e5a559c0f67d3c15ed5899ccd3"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "CUSTOMER_LIFETIME_VALUE", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "null_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('null_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_LIFETIME_VALUE' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Count", "metrics": [{"value": 0.0, "min_value": -1.621320344, "max_value": 2.621320344, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "34c255dc6d77a5b69d1938b7770fc31a"}, {"value": 0.0, "min_value": -1.398717474, "max_value": 2.065384141, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "6259f3ce10dd0d14bc724cc98463bc5e"}, {"value": 1.0, "min_value": -1.232050808, "max_value": 2.232050808, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "ccc5ac6b2d40be3bcb3c83bea8af6be2"}, {"value": 2.0, "min_value": -1.70998008, "max_value": 3.30998008, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "e5e88ba6cd8b5459810ef82096bcad4b"}, {"value": 1.0, "min_value": -1.424984625, "max_value": 3.091651291, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "ee1001b0ad8d6846a7ac01c803be1341"}, {"value": 0.0, "min_value": -1.553501124, "max_value": 2.982072552, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "64a15bf1f9076e10e34fb1a5542d2c38"}, {"value": 0.0, "min_value": -1.607071427, "max_value": 2.857071427, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "6d95230dc410c192038634041c4c5c40"}, {"value": 11.0, "min_value": -8.805227466, "max_value": 12.360783022, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "0032bccfb0ca099e77ae7ddea27445d6"}, {"value": 12.0, "min_value": -11.114021705, "max_value": 16.714021705, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "31c06aa4b9eaabdfe19dbdb891567054"}, {"value": 10.0, "min_value": -11.264644246, "max_value": 18.173735156, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "02d4048153dbbd12e6d9df610f71e468"}, {"value": 6.0, "min_value": -10.539605956, "max_value": 17.872939289, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "064b4a710feb46e18ce45ad09aa3e6cc"}, {"value": 7.0, "min_value": -9.958288561, "max_value": 17.804442407, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "5ac85279daabbecbc426f90f51cd8fc9"}, {"value": 3.0, "min_value": -9.500161602, "max_value": 17.214447316, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "c1da11fcbe0615f39c084b2752c87643"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "FIRST_NAME", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "max_length", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('max_length' as \n    varchar\n)\n                and upper(column_name) = upper(cast('FIRST_NAME' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Max Length", "metrics": [{"value": 10.0, "min_value": 4.757359313, "max_value": 13.242640687, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "b0e0454eb69d76fe93b4773735997e50"}, {"value": 9.0, "min_value": 6.0, "max_value": 12.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "824d27ebe5c1cbab56e4e9ad528fbd3d"}, {"value": 6.0, "min_value": 3.126524617, "max_value": 13.373475383, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "76fee74e3224ecfcfbb13e5b621d4e49"}, {"value": 7.0, "min_value": 3.25658351, "max_value": 12.74341649, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "bb47f5801d12535a883604326cbedc26"}, {"value": 8.0, "min_value": 3.757359313, "max_value": 12.242640687, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "147a33aa50aa6f6f931da2e5c8dcc592"}, {"value": 7.0, "min_value": 3.821586602, "max_value": 11.892699112, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "2836380eee13930c78c5defc23ec29f9"}, {"value": 7.0, "min_value": 3.904780333, "max_value": 11.595219667, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "cc4b43eaf16f19747fb3fd6efea777d1"}, {"value": 5.0, "min_value": 2.916751875, "max_value": 11.972137014, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "a505a305abc9d513f0fdc117ad2fd4b5"}, {"value": 7.0, "min_value": 3.110477882, "max_value": 11.689522118, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "8559e46ef030665be9bd93b0445d3122"}, {"value": 6.0, "min_value": 3.010845486, "max_value": 11.534609059, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "5ee869dd993c23b6ed04bc215d903b24"}, {"value": 7.0, "min_value": 3.179596848, "max_value": 11.320403152, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "d7b79fd2474ce4e3326334cb4689afb0"}, {"value": 8.0, "min_value": 3.360931221, "max_value": 11.254453395, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "26523102f17a917f2e7ebd73c057999a"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "LAST_NAME", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "missing_percent", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('missing_percent' as \n    varchar\n)\n                and upper(column_name) = upper(cast('LAST_NAME' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Missing Percent", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "9b26f4fe9ac6c7eb26021220de5ac298"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "8575800578e3d007cff117c31cc17062"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "6a2b3b8fdfd91272450cdf3c30471862"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "2bd0024af95bdb0a0de5e55c9a87be5d"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "5cf43578c4c2ad1e3a3ffb3b6a0dcc7b"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "78b42186ae00900c29bf4ba3c25d73c8"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "84371191e5d469b1ce5a647155553720"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "31285570c3a710c8c4019cf57dbafe9d"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "3138cf0d52e07ab369aa8a168cdb198a"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "dafc36aa78a5eb649aede3bb0658dc3d"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "3a4792d19ed80201d094967982c1d30c"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "ed4b29aff7f76c2234399b5ee62ccd01"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "LAST_NAME", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "average_length", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('average_length' as \n    varchar\n)\n                and upper(column_name) = upper(cast('LAST_NAME' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Average Length", "metrics": [{"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "d14e0dfbadf03a9da30fb38479781957"}, {"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "b09d3248915260755da356e2a9dd8fa6"}, {"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "d6af7372321fbba490e60082237b0b7b"}, {"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "b937652847d61efe9f6c4a56f66cc19f"}, {"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "e403fa70acde949c7e361fafb225e8e0"}, {"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "7367c6b6f747289b56ad426188e20882"}, {"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "cfaf8d4b12b71204a621f9f18f4779e9"}, {"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "cb775466abfb15a21f5c945d15b69474"}, {"value": 2.8, "min_value": 1.321053362, "max_value": 2.838946638, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "7ae1ec45bd0b182cbc271278979718d4"}, {"value": 3.666667, "min_value": 0.6185704197, "max_value": 3.829914489, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "b0895c8dd6131cfd5ec50f986971e9b5"}, {"value": 3.857143, "min_value": 0.2761928437, "max_value": 4.444442156, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "62e6e79632b894dcebff06bb90d8b83d"}, {"value": 5.0, "min_value": -0.4040460694, "max_value": 5.530786069, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "723b6554cecf43f1e9654e13efcf018d"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "NUMBER_OF_ORDERS", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "null_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('null_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('NUMBER_OF_ORDERS' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Count", "metrics": [{"value": 0.0, "min_value": -1.621320344, "max_value": 2.621320344, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "036034708a882d468fc0e8fff211e859"}, {"value": 0.0, "min_value": -1.398717474, "max_value": 2.065384141, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "cf33dacf5287a9d5afe4dce892d9102e"}, {"value": 1.0, "min_value": -1.232050808, "max_value": 2.232050808, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "c5fce09b6472c33a059e60469df665ff"}, {"value": 2.0, "min_value": -1.70998008, "max_value": 3.30998008, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "6d6d49f1d88dc318cbf62d2f2c4b798d"}, {"value": 1.0, "min_value": -1.424984625, "max_value": 3.091651291, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "08eb5abf0b175df9e5aa0d545cf337e6"}, {"value": 0.0, "min_value": -1.553501124, "max_value": 2.982072552, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "1c0736ec750afb3854f22bc407cd96a6"}, {"value": 0.0, "min_value": -1.607071427, "max_value": 2.857071427, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "70c6eff2a82850470af5f7638958cfc5"}, {"value": 11.0, "min_value": -8.805227466, "max_value": 12.360783022, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "3475b2b52f955878ac99b0bb5c5b83e4"}, {"value": 12.0, "min_value": -11.114021705, "max_value": 16.714021705, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "e2999702018d11f57e81dd9c80468941"}, {"value": 10.0, "min_value": -11.264644246, "max_value": 18.173735156, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "81d91f232dbc084c99c0045b68cc016b"}, {"value": 6.0, "min_value": -10.539605956, "max_value": 17.872939289, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "25dabf27c464d20f2e323c89ce9d6261"}, {"value": 7.0, "min_value": -9.958288561, "max_value": 17.804442407, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "929e5feea829cedd84cd625bf60f5c70"}, {"value": 3.0, "min_value": -9.500161602, "max_value": 17.214447316, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "ec6b85218c31c03076a4bee40517a681"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.not_null_customers_customer_id.5c9bf9911d", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "customers", "column_name": "customer_id", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "dbt_test", "test_sub_type": "not_null", "test_query": "select customer_id\nfrom elementary_tests.jaffle_shop_online.customers\nwhere customer_id is null", "test_params": "{\"column_name\": \"customer_id\", \"model\": \"{{ get_where_subquery(ref('customers')) }}\"}", "test_results": {"display_name": "Not Null - failed results sample", "results_sample": "", "error_message": "No error message", "failed_rows_count": -1}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "CUSTOMER_EMAIL", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "average_length", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('average_length' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_EMAIL' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Average Length", "metrics": [{"value": 24.0, "min_value": 21.855282879, "max_value": 25.326535121, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "0842015f1bdfe07729eb22526d569aeb"}, {"value": 24.285714, "min_value": 22.103656112, "max_value": 25.541365221, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "231d16bfd6ab28faa12030002d888a05"}, {"value": 22.5, "min_value": 21.061868968, "max_value": 25.921897032, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "1c1dbb4f7761cd59711a1b7fbc994685"}, {"value": 23.111111, "min_value": 21.250156316, "max_value": 25.581300884, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "1a91165c86de9144b244195eb6349b24"}, {"value": 24.0, "min_value": 21.448204686, "max_value": 25.578009648, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "ead88082ca9bc25d4b334b19cc94e4b5"}, {"value": 22.5, "min_value": 21.160930058, "max_value": 25.575825085, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "f8152739529a733fb4ffb096b3cf08a8"}, {"value": 23.333333, "min_value": 21.319959727, "max_value": 25.408034273, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "1fdb7477d02fdacf5ef58733451c11f1"}, {"value": 23.0, "min_value": 21.377191889, "max_value": 25.269913889, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "5fe48f3cf47445be20b7a517c9ce0f8b"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "NUMBER_OF_ORDERS", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "zero_percent", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('zero_percent' as \n    varchar\n)\n                and upper(column_name) = upper(cast('NUMBER_OF_ORDERS' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Zero Percent", "metrics": [{"value": 0.0, "min_value": -13.510462423, "max_value": 21.843462423, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "8926d424dce234c9fbdf2eb70c12a7ff"}, {"value": 0.0, "min_value": -11.655512713, "max_value": 17.210846046, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "428a920cdaca7edc7be0c9d955f313f3"}, {"value": 50.0, "min_value": -57.223870122, "max_value": 86.390370122, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "d7ddcd138adb919d867b1baa1e76f573"}, {"value": 18.182, "min_value": -47.0709423, "max_value": 77.6769423, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "b478c152843b725af8ad3b6e1fa76008"}, {"value": 50.0, "min_value": -49.044257611, "max_value": 91.215924278, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "21a11dfe016097ef7a6f16c6bfc37f78"}, {"value": 0.0, "min_value": -50.265064683, "max_value": 86.41220754, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "4f99287e1454e6ea170dc967c49160ff"}, {"value": 0.0, "min_value": -50.295290642, "max_value": 81.924040642, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "4b6dc65df3ca6a0968c9b559bb91b63a"}, {"value": 100.0, "min_value": -79.28929617, "max_value": 129.625962837, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "9ac40097f526e2f41eb2cf10319e0133"}, {"value": 92.308, "min_value": -85.403591496, "max_value": 149.168191496, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "8c34e0cf1d40f1a373ab41d3d8b1a393"}, {"value": 100.0, "min_value": -89.113086791, "max_value": 165.262723155, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "d20bfaa4f9574188a4530f652d791002"}, {"value": 100.0, "min_value": -89.362617423, "max_value": 175.833117423, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "f8cd7d6d70a4204ae60b1f92c94a72aa"}, {"value": 100.0, "min_value": -87.852248529, "max_value": 183.05578699, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "c2f877ac7a165dec08ce8068367e80a1"}, {"value": 100.0, "min_value": -85.408688736, "max_value": 188.097688736, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "62f2b0dbc793e3e073e5684e92c43b96"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "NUMBER_OF_ORDERS", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "null_percent", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('null_percent' as \n    varchar\n)\n                and upper(column_name) = upper(cast('NUMBER_OF_ORDERS' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Percent", "metrics": [{"value": 0.0, "min_value": -13.510462423, "max_value": 21.843462423, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "7a525cf41f871c5a4385ef59b69b8620"}, {"value": 0.0, "min_value": -11.655512713, "max_value": 17.210846046, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "d994a7e5f09239b023cea3ced682adeb"}, {"value": 50.0, "min_value": -57.223870122, "max_value": 86.390370122, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "c7e3d8d7172c37bdc993a8a35a9cbb6a"}, {"value": 18.182, "min_value": -47.0709423, "max_value": 77.6769423, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "c664a6d0b883ca7b4565821a161d059a"}, {"value": 50.0, "min_value": -49.044257611, "max_value": 91.215924278, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "3657812d2f135c149b4aed773e1b8250"}, {"value": 0.0, "min_value": -50.265064683, "max_value": 86.41220754, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "a411c73c8e22d18eacc951b01be72319"}, {"value": 0.0, "min_value": -50.295290642, "max_value": 81.924040642, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "33e334f65a97186ef043d296fa4b59d5"}, {"value": 100.0, "min_value": -79.28929617, "max_value": 129.625962837, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "74787d1c5215c63469b5dec350437be2"}, {"value": 92.308, "min_value": -85.403591496, "max_value": 149.168191496, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "37120c4bf79f94c436bf43f61118c596"}, {"value": 100.0, "min_value": -89.113086791, "max_value": 165.262723155, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "a2fb59e3686fb0f405fdfcc86be69143"}, {"value": 100.0, "min_value": -89.362617423, "max_value": 175.833117423, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "69d62e638db63cfa0deb777d916c9982"}, {"value": 100.0, "min_value": -87.852248529, "max_value": 183.05578699, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "3a436b00ede579cdfd8e5bd7afd6eba2"}, {"value": 100.0, "min_value": -85.408688736, "max_value": 188.097688736, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "09675e62df4bcd3e275165fb826580d0"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "CUSTOMER_EMAIL", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "max_length", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('max_length' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_EMAIL' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Max Length", "metrics": [{"value": 28.0, "min_value": 20.136038969, "max_value": 32.863961031, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "5db87a0d4512fd2f32a4efd0f6a0c8dc"}, {"value": 26.0, "min_value": 21.750757638, "max_value": 30.915909028, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "4a86c8446ab4d3a00c5189f93482db4a"}, {"value": 24.0, "min_value": 20.626524617, "max_value": 30.873475383, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "24b2ad9a402cd61e789492a6935fc3d5"}, {"value": 25.0, "min_value": 21.050274734, "max_value": 30.149725266, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "ca39042e3c37e598e9fee065d1d6c855"}, {"value": 26.0, "min_value": 21.56788636, "max_value": 29.765446973, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "be9058391292445284a64542aedb493e"}, {"value": 23.0, "min_value": 20.475011931, "max_value": 30.09641664, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "504ac9176e698e802d1a1eb4210f68ad"}, {"value": 24.0, "min_value": 20.467057474, "max_value": 29.782942526, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "9ca92616fd644a54cbf12d9d1a68a2d7"}, {"value": 23.0, "min_value": 20.041209031, "max_value": 29.736568746, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "98850fc3f86118c859038a1771f27db9"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "LAST_NAME", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "missing_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('missing_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('LAST_NAME' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Missing Count", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "df4d8994dd8a3889281c07eb6a10e0b8"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "c72d425583fe94ac0e67df395a6e2c5b"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "96290926c93d027f3b2032cfe02b0117"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "a553d7b601b6895b7d33ac752fa764bb"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "2716cb771e8827754334b5bafba0bc36"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "335111c39c6fc82ed69011a57e2bb72e"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "24ed79504f20be2fe131a884480e9323"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "bc1d7f0a340b903f35f4b000fe4290a3"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "dd50b6fb18abd1b0a80a45f28f5196fe"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "601cad5784479b9540c9bd7e1263b6cd"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "17de2ddb993e74f226f6b8e6138f2ef1"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "af49af778248566b608ec7fb175d259e"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "FIRST_ORDER", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "null_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('null_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('FIRST_ORDER' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Count", "metrics": [{"value": 0.0, "min_value": -1.621320344, "max_value": 2.621320344, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "8807de9533890aa6d65eb70e0406d778"}, {"value": 0.0, "min_value": -1.398717474, "max_value": 2.065384141, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "6b7a2cd23fc0dfde8702de4f29ca105a"}, {"value": 1.0, "min_value": -1.232050808, "max_value": 2.232050808, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "85fef4100cdb569cf2363d168fd9fffe"}, {"value": 2.0, "min_value": -1.70998008, "max_value": 3.30998008, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "3988a978eeeb8174b27db9969a348931"}, {"value": 1.0, "min_value": -1.424984625, "max_value": 3.091651291, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "fa9b9bc8eb7dcc95aba7d9833732e8c8"}, {"value": 0.0, "min_value": -1.553501124, "max_value": 2.982072552, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "c3757a2d94def0baa57a12f281562129"}, {"value": 0.0, "min_value": -1.607071427, "max_value": 2.857071427, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "c312553d19bce2246a826a2cc1c8c95c"}, {"value": 0.0, "min_value": -1.623893916, "max_value": 2.735005027, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "b3b1abce87cd41c8f19e2d270029501a"}, {"value": 10.0, "min_value": -7.692388155, "max_value": 10.692388155, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "a20f885bdec42d78b020d0b7596f865f"}, {"value": 6.0, "min_value": -7.714743141, "max_value": 11.532924959, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "d68061510ede7a5e5ac44105262c3671"}, {"value": 7.0, "min_value": -7.846861342, "max_value": 12.513528009, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "2b794700b2e59d27302583e7a8a1c7fd"}, {"value": 3.0, "min_value": -7.377950482, "max_value": 12.147181252, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "4bbf14413bdf1f58e6ca0dbce2943d93"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.unique_customers_customer_email.cc1ffc0a40", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "customers", "column_name": "customer_email", "test_name": "unique", "test_display_name": "Unique", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "dbt_test", "test_sub_type": "unique", "test_query": "select\n    customer_email as unique_field,\n    count(*) as n_records\n\nfrom elementary_tests.jaffle_shop_online.customers\nwhere customer_email is not null\ngroup by customer_email\nhaving count(*) > 1", "test_params": "{\"column_name\": \"customer_email\", \"model\": \"{{ get_where_subquery(ref('customers')) }}\"}", "test_results": {"display_name": "Unique - failed results sample", "results_sample": "", "error_message": "No error message", "failed_rows_count": -1}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "CUSTOMER_LIFETIME_VALUE", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "min", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('min' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_LIFETIME_VALUE' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Min", "metrics": [{"value": 16.0, "min_value": -20.69848481, "max_value": 38.69848481, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "954e39f7b83dd11426f59a7d810bfd5e"}, {"value": 19.0, "min_value": -14.887981844, "max_value": 39.554648511, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "cc4fffd66e2359d668965c977ad50426"}, {"value": 9.0, "min_value": -11.2815715, "max_value": 34.2815715, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "f74e6f9b48649e85c2de29322b1988a1"}, {"value": 9.0, "min_value": -9.012496096, "max_value": 31.012496096, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "af061a2b8d4a2d6913b43f342767fdbc"}, {"value": 50.0, "min_value": -33.508822766, "max_value": 68.508822766, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "70eef4854fa9ecd0bb071d4e7f9c801a"}, {"value": 15.0, "min_value": -29.50782039, "max_value": 63.793534676, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "b21981bdd16174e650dd476bfbdfc3ca"}, {"value": 9.0, "min_value": -27.920228378, "max_value": 60.170228378, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "edb155e418d2a1c748bb8c6bbe537e98"}, {"value": 30.0, "min_value": -25.807463572, "max_value": 61.140796905, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "61ed76c56edc61bc03048dcc7e87d51c"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "CUSTOMER_LIFETIME_VALUE", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "max", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('max' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_LIFETIME_VALUE' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Max", "metrics": [{"value": 90.0, "min_value": 53.30151519, "max_value": 112.69848481, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "deb7025a042730acc116cdf7e2d7a6d6"}, {"value": 110.0, "min_value": 40.735977528, "max_value": 143.264022472, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "c39b8daf55337bc2f3b28119da145be9"}, {"value": 9.0, "min_value": -60.09782069, "max_value": 202.59782069, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "23020142cbac1bbc1f75d29249eab764"}, {"value": 57.0, "min_value": -46.946001231, "max_value": 183.746001231, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "f066b70fad6ecfcac40eaf936cb95b29"}, {"value": 50.0, "min_value": -40.267803024, "max_value": 170.934469691, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "d410dc848dc07efbf6bf83b63ecffbd8"}, {"value": 24.0, "min_value": -47.760847026, "max_value": 166.617989883, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "e6f057160af2b8eda071a390ce29637d"}, {"value": 63.0, "min_value": -39.435390048, "max_value": 159.185390048, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "1df2b47b92fbbce2a1f0a7acc5697f87"}, {"value": 30.0, "min_value": -41.02646123, "max_value": 154.137572341, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "6295871a83cbc310cd0d82dfbaad3857"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "CUSTOMER_EMAIL", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "null_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('null_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_EMAIL' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Null Count", "metrics": [{"value": 0.0, "min_value": -1.621320344, "max_value": 2.621320344, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "05961dd520eaad30eefd0feb75b1136d"}, {"value": 0.0, "min_value": -1.398717474, "max_value": 2.065384141, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "d5cedc5908ae9c6b278f416cbbc7c5f1"}, {"value": 0.0, "min_value": -1.25, "max_value": 1.75, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "3c47a50ac72369b7f250f164ec289d57"}, {"value": 2.0, "min_value": -2.083281573, "max_value": 3.283281573, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "70f03e73a4b12b35425fdda116b84138"}, {"value": 0.0, "min_value": -2.00998008, "max_value": 3.00998008, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "3b637a999eb06f2739841800e0e8129c"}, {"value": 0.0, "min_value": -1.931815949, "max_value": 2.788958806, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "0b1d4003bdbfb1c5c4fcda849c5dde99"}, {"value": 0.0, "min_value": -1.857071427, "max_value": 2.607071427, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "2e7d0e0f63132fe38898da0e82688935"}, {"value": 0.0, "min_value": -1.78798701, "max_value": 2.454653677, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "a84ae0b4d46d4a00994b24b242fa7968"}, {"value": 10.0, "min_value": -8.086160024, "max_value": 10.686160024, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "dac28b9e424654303c6a9ea54a77c4aa"}, {"value": 6.0, "min_value": -8.140028645, "max_value": 11.594574099, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "5c6e4c23c101241a3ea19254f544b505"}, {"value": 7.0, "min_value": -8.291040365, "max_value": 12.624373698, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "1c9869902004d3ac430f965df4b754e4"}, {"value": 3.0, "min_value": -7.805702721, "max_value": 12.267241182, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "70f7a5d6038c13785e03de80cce14fb0"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "NUMBER_OF_ORDERS", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "max", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('max' as \n    varchar\n)\n                and upper(column_name) = upper(cast('NUMBER_OF_ORDERS' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Max", "metrics": [{"value": 4.0, "min_value": 1.378679656, "max_value": 5.621320344, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "7263239e680233fc7144645d47bd08c0"}, {"value": 5.0, "min_value": 1.0, "max_value": 7.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "2948e39ca0f380b16b38e15e31aa8c7e"}, {"value": 1.0, "min_value": -1.873475383, "max_value": 8.373475383, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "69794690d3c601559709a82ee77b0b13"}, {"value": 3.0, "min_value": -1.249719092, "max_value": 7.649719092, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "728ac6de78b2ddbcdc23300f0f5577aa"}, {"value": 2.0, "min_value": -1.242640687, "max_value": 7.242640687, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "3683bfa78ba749550818af74ab36611e"}, {"value": 2.0, "min_value": -1.178413398, "max_value": 6.892699112, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "520104c97469e9a90e977950ec805753"}, {"value": 3.0, "min_value": -0.8642703643, "max_value": 6.614270364, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "250bf24c7efe9e04bacc099414c8dd61"}, {"value": 2.0, "min_value": -0.8277734977, "max_value": 6.383329053, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "1dd705bd25e426e6e3ea6b8816e700c6"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "LAST_NAME", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "max_length", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('max_length' as \n    varchar\n)\n                and upper(column_name) = upper(cast('LAST_NAME' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Max Length", "metrics": [{"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "5c8af47e69face85772c986a85584a2b"}, {"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "0f060edac7a38e39179495f5d32696db"}, {"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "cb4b09b6c6e6756507f9e13661bc2b5c"}, {"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "69251173e93d1cd8bf769537a693b08b"}, {"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "c5053e4bb8f974335b40d136a4ded692"}, {"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "50fb564761980ef60689eac24691e724"}, {"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "1fe5f6353bb70e72bfcd55311926afc6"}, {"value": 2.0, "min_value": 2.0, "max_value": 2.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "9681d47a8c6a3890c66cfff33cca8cbc"}, {"value": 5.0, "min_value": -0.5460498942, "max_value": 5.146049894, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "b9f7dac82b15b05108fe0beea5a1a729"}, {"value": 6.0, "min_value": -1.663742071, "max_value": 6.936469343, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "6a15407cbe21de24ec678a33bec0c2b4"}, {"value": 5.0, "min_value": -1.749242362, "max_value": 7.415909028, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "a8a40c8d67aa0c371f74cd435d2cea53"}, {"value": 7.0, "min_value": -2.438043578, "max_value": 8.745735885, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "90a8b75b36c8aa62797e2c2f1d27b147"}], "result_description": ""}}, {"test_unique_id": "test.jaffle_shop_online.elementary_all_columns_anomalies_customers_.44eb8e310e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "CUSTOMERS", "column_name": "CUSTOMER_ID", "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2022-06-16 23:33:09", "latest_run_time_utc": "2022-06-16 20:33:09", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.customers", "table_unique_id": "elementary_tests.jaffle_shop_online.customers", "test_type": "anomaly_detection", "test_sub_type": "variance", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_ALL_COLUMNS_ANOMALIES_CUSTOMERS___ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.CUSTOMERS' as \n    varchar\n))\n              and metric_name = cast('variance' as \n    varchar\n)\n                and upper(column_name) = upper(cast('CUSTOMER_ID' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "signup_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Variance", "metrics": [{"value": 162046.4, "min_value": -12230.579024219, "max_value": 443814.153266644, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "9cfef94cde45643d841729fbbc712d9a"}, {"value": 461887.80952381, "min_value": -157902.939823908, "max_value": 753550.529001397, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "a8e67a62c974319b7250c06501f2d64a"}, {"value": 448404.5, "min_value": -99819.024758362, "max_value": 770756.966641479, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "31e5e1a6612e4f99aee72308671b8b66"}, {"value": 391109.272727273, "min_value": -37693.54512673, "max_value": 730887.607724132, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "6f4c49d1ae38227f75a63adafed801c2"}, {"value": 1475762.0, "min_value": -890222.381753732, "max_value": 1959804.76725157, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "8f23774c628a933c489f533e09fe130f"}, {"value": 1164338.0, "min_value": -859115.128018309, "max_value": 2108568.0298736, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "ba62fb27db6df5beaebf9fb7c38b99c8"}, {"value": 209746.333333333, "min_value": -869706.134825474, "max_value": 2015414.00728218, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "b1f160fb21013878324a79ec69e16a96"}, {"value": 681.763636364, "min_value": -956407.656448516, "max_value": 1974966.15721812, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "80861fb2b081a716ac1b60a52c4a50b5"}, {"value": 10045.897435897, "min_value": -1001416.32324247, "max_value": 1920128.15342229, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "2378a53b9337c846d81c8f70a70e3ba0"}, {"value": 2798.766666667, "min_value": -1028183.65795878, "max_value": 1863885.09751619, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "2025e889c8376a4c2e18bf32ace41b25"}, {"value": 3637.466666667, "min_value": -1041308.26047312, "max_value": 1807974.15784519, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "a66025ad066cf57b55c66608b2fae620"}, {"value": 1552.904761905, "min_value": -1046526.45646314, "max_value": 1754456.96246227, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "1e08894b2d60ce24c08cacbe2392466e"}, {"value": 4358.333333333, "min_value": -1045442.94897939, "max_value": 1703429.60931192, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "1f9c71f1ab4ae7e368dbdd0b060dde71"}], "result_description": ""}}], "model.jaffle_shop_online.orders": [{"test_unique_id": "test.jaffle_shop_online.not_null_orders_customer_id.c5f02694af", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "orders", "column_name": "customer_id", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.orders", "table_unique_id": "elementary_tests.jaffle_shop_online.orders", "test_type": "dbt_test", "test_sub_type": "not_null", "test_query": "select customer_id\nfrom elementary_tests.jaffle_shop_online.orders\nwhere customer_id is null", "test_params": "{\"column_name\": \"customer_id\", \"model\": \"{{ get_where_subquery(ref('orders')) }}\"}", "test_results": {"display_name": "Not Null - failed results sample", "results_sample": "", "error_message": "No error message", "failed_rows_count": -1}}, {"test_unique_id": "test.jaffle_shop_online.unique_orders_order_id.fed79b3a6e", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "orders", "column_name": "order_id", "test_name": "unique", "test_display_name": "Unique", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.orders", "table_unique_id": "elementary_tests.jaffle_shop_online.orders", "test_type": "dbt_test", "test_sub_type": "unique", "test_query": "select\n    order_id as unique_field,\n    count(*) as n_records\n\nfrom elementary_tests.jaffle_shop_online.orders\nwhere order_id is not null\ngroup by order_id\nhaving count(*) > 1", "test_params": "{\"column_name\": \"order_id\", \"model\": \"{{ get_where_subquery(ref('orders')) }}\"}", "test_results": {"display_name": "Unique - failed results sample", "results_sample": "", "error_message": "No error message", "failed_rows_count": -1}}, {"test_unique_id": "test.jaffle_shop_online.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "orders", "column_name": "customer_id", "test_name": "relationships", "test_display_name": "Relationships", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.orders", "table_unique_id": "elementary_tests.jaffle_shop_online.orders", "test_type": "dbt_test", "test_sub_type": "relationships", "test_query": "with child as (\n    select customer_id as from_field\n    from elementary_tests.jaffle_shop_online.orders\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from elementary_tests.jaffle_shop_online.customers\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null", "test_params": "{\"to\": \"ref('customers')\", \"field\": \"customer_id\", \"column_name\": \"customer_id\", \"model\": \"{{ get_where_subquery(ref('orders')) }}\"}", "test_results": {"display_name": "Relationships - failed results sample", "results_sample": "", "error_message": "No error message", "failed_rows_count": -1}}, {"test_unique_id": "test.jaffle_shop_online.not_null_orders_gift_card_amount.413a0d2d7a", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "orders", "column_name": "gift_card_amount", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.orders", "table_unique_id": "elementary_tests.jaffle_shop_online.orders", "test_type": "dbt_test", "test_sub_type": "not_null", "test_query": "select gift_card_amount\nfrom elementary_tests.jaffle_shop_online.orders\nwhere gift_card_amount is null", "test_params": "{\"column_name\": \"gift_card_amount\", \"model\": \"{{ get_where_subquery(ref('orders')) }}\"}", "test_results": {"display_name": "Not Null - failed results sample", "results_sample": "", "error_message": "No error message", "failed_rows_count": -1}}, {"test_unique_id": "test.jaffle_shop_online.not_null_orders_bank_transfer_amount.7743500c49", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "orders", "column_name": "bank_transfer_amount", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.orders", "table_unique_id": "elementary_tests.jaffle_shop_online.orders", "test_type": "dbt_test", "test_sub_type": "not_null", "test_query": "select bank_transfer_amount\nfrom elementary_tests.jaffle_shop_online.orders\nwhere bank_transfer_amount is null", "test_params": "{\"column_name\": \"bank_transfer_amount\", \"model\": \"{{ get_where_subquery(ref('orders')) }}\"}", "test_results": {"display_name": "Not Null - failed results sample", "results_sample": "", "error_message": "No error message", "failed_rows_count": -1}}, {"test_unique_id": "test.jaffle_shop_online.elementary_column_anomalies_orders_zero_count__zero_percent__amount.f991f79acf", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "ORDERS", "column_name": "AMOUNT", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "latest_run_time": "2022-06-16 23:33:04", "latest_run_time_utc": "2022-06-16 20:33:04", "latest_run_status": "fail", "model_unique_id": "model.jaffle_shop_online.orders", "table_unique_id": "elementary_tests.jaffle_shop_online.orders", "test_type": "anomaly_detection", "test_sub_type": "zero_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_COLUMN_ANOMALIES_ORDERS_ZERO_COUNT__ZERO_PERCENT__AMOUNT__ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.ORDERS' as \n    varchar\n))\n              and metric_name = cast('zero_count' as \n    varchar\n)\n                and upper(column_name) = upper(cast('AMOUNT' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "order_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Zero Count", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "b704ed78ae02f636f4a2088caa5008d2"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "c60a404effd40a35967096a40f70d021"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "206ba233b4b04f3a4e3e88742ca21b0b"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "86c6dd64f82cdb90c24f994b64fe2832"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "dfbbb129c90961e9ba8a874d5dc5760d"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "ec51d412c701b8105f40e1967d85ffaa"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "eeaab8431d47523000ebff50311bfee9"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "5f13b8b4c5fc4e47d1d0b831c012d257"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "05c4e7623513352dbe2518ea0b64938a"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "f9538a4e73c09dab2e3eb4e925b91bc3"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "9ba87154b8105933c3a77108ffb21f3f"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "332815064964660620d9f3c0485a56f4"}, {"value": 50.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "0bf17ae676368319b6552b48133d96c1"}], "result_description": "In column AMOUNT, the last zero_count value is 50. The average for this metric is 3.571."}}, {"test_unique_id": "test.jaffle_shop_online.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "orders", "column_name": "status", "test_name": "accepted_values", "test_display_name": "Accepted Values", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "fail", "model_unique_id": "model.jaffle_shop_online.orders", "table_unique_id": "elementary_tests.jaffle_shop_online.orders", "test_type": "dbt_test", "test_sub_type": "accepted_values", "test_query": "with all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from elementary_tests.jaffle_shop_online.orders\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'placed','shipped','completed','return_pending','returned'\n)", "test_params": "{\"values\": [\"placed\", \"shipped\", \"completed\", \"return_pending\", \"returned\"], \"column_name\": \"status\", \"model\": \"{{ get_where_subquery(ref('orders')) }}\"}", "test_results": {"display_name": "Accepted Values - failed results sample", "results_sample": [{"value_field": "lost", "n_records": 26.0}], "error_message": "Got 1 result, configured to fail if != 0", "failed_rows_count": 1}}, {"test_unique_id": "test.jaffle_shop_online.elementary_column_anomalies_orders_zero_count__zero_percent__amount.f991f79acf", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "ORDERS", "column_name": "AMOUNT", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "latest_run_time": "2022-06-16 23:33:04", "latest_run_time_utc": "2022-06-16 20:33:04", "latest_run_status": "fail", "model_unique_id": "model.jaffle_shop_online.orders", "table_unique_id": "elementary_tests.jaffle_shop_online.orders", "test_type": "anomaly_detection", "test_sub_type": "zero_percent", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_COLUMN_ANOMALIES_ORDERS_ZERO_COUNT__ZERO_PERCENT__AMOUNT__ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.ORDERS' as \n    varchar\n))\n              and metric_name = cast('zero_percent' as \n    varchar\n)\n                and upper(column_name) = upper(cast('AMOUNT' as \n    varchar\n))\n        order by bucket_end", "test_params": {"timestamp_column": "order_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Zero Percent", "metrics": [{"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "537fc650910c0864e7d663c9859d4be8"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "9f4dff593abfea6879ff733213929573"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "0ddab85585a8995a237c0326a303edd4"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "8912f60588f679d29753d99d76f8ecf5"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "3e00e76ee916e1599743ff47cd32bd52"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "2229c6a2b755592b16a001651d9cf0d9"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "f3288490921d86f2b5ce7fdd524aa42f"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "1a3f2754354a680422c5632a6c082e28"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "bab3e4b44ec869aaa98f4c100937f967"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "362d8dd25510a788f297b1520ea5042e"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "b7fddadfd1719c355aa3a8ba62269842"}, {"value": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "350e6482d3a6dcc32a36c7bbdddb5b17"}, {"value": 100.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "5c45dec7d8556af3bf41a2188836a702"}], "result_description": "In column AMOUNT, the last zero_percent value is 100. The average for this metric is 7.143."}}, {"test_unique_id": "test.jaffle_shop_online.not_null_orders_credit_card_amount.d3ca593b59", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "orders", "column_name": "credit_card_amount", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.orders", "table_unique_id": "elementary_tests.jaffle_shop_online.orders", "test_type": "dbt_test", "test_sub_type": "not_null", "test_query": "select credit_card_amount\nfrom elementary_tests.jaffle_shop_online.orders\nwhere credit_card_amount is null", "test_params": "{\"column_name\": \"credit_card_amount\", \"model\": \"{{ get_where_subquery(ref('orders')) }}\"}", "test_results": {"display_name": "Not Null - failed results sample", "results_sample": "", "error_message": "No error message", "failed_rows_count": -1}}, {"test_unique_id": "test.jaffle_shop_online.not_null_orders_order_id.cf6c17daed", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "orders", "column_name": "order_id", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.orders", "table_unique_id": "elementary_tests.jaffle_shop_online.orders", "test_type": "dbt_test", "test_sub_type": "not_null", "test_query": "select order_id\nfrom elementary_tests.jaffle_shop_online.orders\nwhere order_id is null", "test_params": "{\"column_name\": \"order_id\", \"model\": \"{{ get_where_subquery(ref('orders')) }}\"}", "test_results": {"display_name": "Not Null - failed results sample", "results_sample": "", "error_message": "No error message", "failed_rows_count": -1}}, {"test_unique_id": "test.jaffle_shop_online.not_null_orders_amount.106140f9fd", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "orders", "column_name": "amount", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.orders", "table_unique_id": "elementary_tests.jaffle_shop_online.orders", "test_type": "dbt_test", "test_sub_type": "not_null", "test_query": "select amount\nfrom elementary_tests.jaffle_shop_online.orders\nwhere amount is null", "test_params": "{\"column_name\": \"amount\", \"model\": \"{{ get_where_subquery(ref('orders')) }}\"}", "test_results": {"display_name": "Not Null - failed results sample", "results_sample": "", "error_message": "No error message", "failed_rows_count": -1}}, {"test_unique_id": "test.jaffle_shop_online.not_null_orders_coupon_amount.ab90c90625", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "orders", "column_name": "coupon_amount", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.orders", "table_unique_id": "elementary_tests.jaffle_shop_online.orders", "test_type": "dbt_test", "test_sub_type": "not_null", "test_query": "select coupon_amount\nfrom elementary_tests.jaffle_shop_online.orders\nwhere coupon_amount is null", "test_params": "{\"column_name\": \"coupon_amount\", \"model\": \"{{ get_where_subquery(ref('orders')) }}\"}", "test_results": {"display_name": "Not Null - failed results sample", "results_sample": "", "error_message": "No error message", "failed_rows_count": -1}}, {"test_unique_id": "test.jaffle_shop_online.elementary_table_anomalies_orders_row_count.35399dcb3e", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "ORDERS", "column_name": "", "test_name": "table_anomalies", "test_display_name": "Table Anomalies", "latest_run_time": "2022-06-16 23:33:06", "latest_run_time_utc": "2022-06-16 20:33:06", "latest_run_status": "warn", "model_unique_id": "model.jaffle_shop_online.orders", "table_unique_id": "elementary_tests.jaffle_shop_online.orders", "test_type": "anomaly_detection", "test_sub_type": "row_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_TABLE_ANOMALIES_ORDERS_ROW_COUNT__ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.ORDERS' as \n    varchar\n))\n              and metric_name = cast('row_count' as \n    varchar\n)\n        order by bucket_end", "test_params": {"timestamp_column": "order_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Row Count", "metrics": [{"value": 306.0, "min_value": 299.514718626, "max_value": 316.485281374, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "ab47b3b43f87a546561c46e050cc7c29"}, {"value": 287.0, "min_value": 264.135382818, "max_value": 337.864617182, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "793120bb803497c1907978ea26ad4dd4"}, {"value": 291.0, "min_value": 264.869656558, "max_value": 332.130343442, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "ae143179b3b53ba3dd44300b2c6dc024"}, {"value": 278.0, "min_value": 254.341293081, "max_value": 334.458706919, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "a58829828ddc0bceac02d876fe700879"}, {"value": 286.0, "min_value": 255.722661039, "max_value": 330.277338961, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "be7cab33e96afd23484439bcbf3474ec"}, {"value": 315.0, "min_value": 253.94942502, "max_value": 338.336289265, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "85e255785076c25b4d1071ec4c3e13db"}, {"value": 279.0, "min_value": 250.912050077, "max_value": 337.087949923, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "520e64f9e53646bc8c1dcc6df117f189"}, {"value": 272.0, "min_value": 245.63714966, "max_value": 337.473961451, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "747598f8f19015a199634601e1c27e45"}, {"value": 274.0, "min_value": 243.414657488, "max_value": 336.185342512, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "e451bd49deb3330751837d47e1b6b853"}, {"value": 269.0, "min_value": 240.050777297, "max_value": 335.767404521, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "90762027fa84a6c33ff2e678aa9fd491"}, {"value": 278.0, "min_value": 240.652299433, "max_value": 333.514367234, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "aea56ffb10e51675a11048fee650f625"}, {"value": 297.0, "min_value": 242.632558205, "max_value": 333.059749487, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "b9a8e60d1a00b635430bb82341475ca0"}, {"value": 50.0, "min_value": 242.632558205, "max_value": 333.059749487, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "205a216aafe92a83a39a3af20d2ea638"}], "result_description": "The last row_count value is 50. The average for this metric is 270.857."}}], "model.jaffle_shop_online.stg_customers": [{"test_unique_id": "test.jaffle_shop_online.unique_stg_customers_customer_id.c7614daada", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "stg_customers", "column_name": "customer_id", "test_name": "unique", "test_display_name": "Unique", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_customers", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_customers", "test_type": "dbt_test", "test_sub_type": "unique", "test_query": "select\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom elementary_tests.jaffle_shop_online.stg_customers\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1", "test_params": "{\"column_name\": \"customer_id\", \"model\": \"{{ get_where_subquery(ref('stg_customers')) }}\"}", "test_results": {"display_name": "Unique - failed results sample", "results_sample": "", "error_message": "No error message", "failed_rows_count": -1}}, {"test_unique_id": "test.jaffle_shop_online.not_null_stg_customers_customer_id.e2cfb1f9aa", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "stg_customers", "column_name": "customer_id", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_customers", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_customers", "test_type": "dbt_test", "test_sub_type": "not_null", "test_query": "select customer_id\nfrom elementary_tests.jaffle_shop_online.stg_customers\nwhere customer_id is null", "test_params": "{\"column_name\": \"customer_id\", \"model\": \"{{ get_where_subquery(ref('stg_customers')) }}\"}", "test_results": {"display_name": "Not Null - failed results sample", "results_sample": "", "error_message": "No error message", "failed_rows_count": -1}}, {"test_unique_id": "test.jaffle_shop_online.relationships_stg_customers_customer_id__customer_id__ref_stg_signups_.bfea9c9141", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "stg_customers", "column_name": "customer_id", "test_name": "relationships", "test_display_name": "Relationships", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "fail", "model_unique_id": "model.jaffle_shop_online.stg_customers", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_customers", "test_type": "dbt_test", "test_sub_type": "relationships", "test_query": "with child as (\n    select customer_id as from_field\n    from elementary_tests.jaffle_shop_online.stg_customers\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from elementary_tests.jaffle_shop_online.stg_signups\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null", "test_params": "{\"to\": \"ref('stg_signups')\", \"field\": \"customer_id\", \"column_name\": \"customer_id\", \"model\": \"{{ get_where_subquery(ref('stg_customers')) }}\"}", "test_results": {"display_name": "Relationships - failed results sample", "results_sample": [{"from_field": 2002.0}, {"from_field": 2001.0}], "error_message": "Got 2 results, configured to fail if != 0", "failed_rows_count": 2}}], "model.jaffle_shop_online.stg_orders": [{"test_unique_id": "test.jaffle_shop_online.unique_stg_orders_order_id.e3b841c71a", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "stg_orders", "column_name": "order_id", "test_name": "unique", "test_display_name": "Unique", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_orders", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_orders", "test_type": "dbt_test", "test_sub_type": "unique", "test_query": "select\n    order_id as unique_field,\n    count(*) as n_records\n\nfrom elementary_tests.jaffle_shop_online.stg_orders\nwhere order_id is not null\ngroup by order_id\nhaving count(*) > 1", "test_params": "{\"column_name\": \"order_id\", \"model\": \"{{ get_where_subquery(ref('stg_orders')) }}\"}", "test_results": {"display_name": "Unique - failed results sample", "results_sample": "", "error_message": "No error message", "failed_rows_count": -1}}, {"test_unique_id": "test.jaffle_shop_online.not_null_stg_orders_order_id.81cfe2fe64", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "stg_orders", "column_name": "order_id", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_orders", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_orders", "test_type": "dbt_test", "test_sub_type": "not_null", "test_query": "select order_id\nfrom elementary_tests.jaffle_shop_online.stg_orders\nwhere order_id is null", "test_params": "{\"column_name\": \"order_id\", \"model\": \"{{ get_where_subquery(ref('stg_orders')) }}\"}", "test_results": {"display_name": "Not Null - failed results sample", "results_sample": "", "error_message": "No error message", "failed_rows_count": -1}}, {"test_unique_id": "test.jaffle_shop_online.elementary_table_anomalies_stg_orders_row_count.68285cd808", "database_name": "ELEMENTARY_TESTS", "schema_name": "JAFFLE_SHOP_ONLINE", "table_name": "STG_ORDERS", "column_name": "", "test_name": "table_anomalies", "test_display_name": "Table Anomalies", "latest_run_time": "2022-06-16 23:33:07", "latest_run_time_utc": "2022-06-16 20:33:07", "latest_run_status": "fail", "model_unique_id": "model.jaffle_shop_online.stg_orders", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_orders", "test_type": "anomaly_detection", "test_sub_type": "row_count", "test_query": "with anomaly_scores as (\n            select * from \"ELEMENTARY_TESTS\".\"JAFFLE_SHOP_ONLINE_ELEMENTARY__TESTS\".\"ELEMENTARY_TABLE_ANOMALIES_STG_ORDERS_ROW_COUNT__ANOMALY_SCORES\"\n        ),\n        anomaly_scores_with_is_anomalous as (\n        select  *,\n                case when abs(anomaly_score) > 3\n                and bucket_end >= \n    dateadd(day, '-2', cast('2022-06-16 00:00:00' as\n    timestamp_ntz\n))\n\n                and training_set_size >= 13 then TRUE else FALSE end as is_anomalous\n            from anomaly_scores\n        )\n        select metric_value as value,\n               case when is_anomalous = TRUE then\n                lag(min_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n               else min_metric_value end as min_value,\n               case when is_anomalous = TRUE then\n                lag(max_metric_value) over (partition by full_table_name, column_name, metric_name order by bucket_end)\n                else max_metric_value end as max_value,\n               bucket_start as start_time,\n               bucket_end as end_time,\n               metric_id\n        from anomaly_scores_with_is_anomalous\n        where upper(full_table_name) = upper(cast('ELEMENTARY_TESTS.JAFFLE_SHOP_ONLINE.STG_ORDERS' as \n    varchar\n))\n              and metric_name = cast('row_count' as \n    varchar\n)\n        order by bucket_end", "test_params": {"timestamp_column": "order_date", "anomaly_threshold": 3}, "test_results": {"display_name": "Row Count", "metrics": [{"value": 306.0, "min_value": 299.514718626, "max_value": 316.485281374, "start_time": "2022-06-03T00:00:00", "end_time": "2022-06-04T00:00:00", "metric_id": "3d077a1193d3e6e8dafa21491e084f06"}, {"value": 287.0, "min_value": 264.135382818, "max_value": 337.864617182, "start_time": "2022-06-04T00:00:00", "end_time": "2022-06-05T00:00:00", "metric_id": "e1d90040f27116b3035310e7352a1aea"}, {"value": 291.0, "min_value": 264.869656558, "max_value": 332.130343442, "start_time": "2022-06-05T00:00:00", "end_time": "2022-06-06T00:00:00", "metric_id": "a0f7f6e4e986abe1c98785cf5c58c195"}, {"value": 278.0, "min_value": 254.341293081, "max_value": 334.458706919, "start_time": "2022-06-06T00:00:00", "end_time": "2022-06-07T00:00:00", "metric_id": "4cffd56b1ae63da9d698237c6f14edb1"}, {"value": 286.0, "min_value": 255.722661039, "max_value": 330.277338961, "start_time": "2022-06-07T00:00:00", "end_time": "2022-06-08T00:00:00", "metric_id": "94615c98d5d63b0e582f8f317127aeff"}, {"value": 315.0, "min_value": 253.94942502, "max_value": 338.336289265, "start_time": "2022-06-08T00:00:00", "end_time": "2022-06-09T00:00:00", "metric_id": "bc049d5772c313832aaf6964610fc875"}, {"value": 279.0, "min_value": 250.912050077, "max_value": 337.087949923, "start_time": "2022-06-09T00:00:00", "end_time": "2022-06-10T00:00:00", "metric_id": "a77cff0dc5078674524a6db7ba53fd45"}, {"value": 272.0, "min_value": 245.63714966, "max_value": 337.473961451, "start_time": "2022-06-10T00:00:00", "end_time": "2022-06-11T00:00:00", "metric_id": "609ca25c26b9eed9c285843ac3719e81"}, {"value": 274.0, "min_value": 243.414657488, "max_value": 336.185342512, "start_time": "2022-06-11T00:00:00", "end_time": "2022-06-12T00:00:00", "metric_id": "70fab800f5ed362e8e4532eb4995fa74"}, {"value": 269.0, "min_value": 240.050777297, "max_value": 335.767404521, "start_time": "2022-06-12T00:00:00", "end_time": "2022-06-13T00:00:00", "metric_id": "b024d73dd8f5406cec20ad28f817157f"}, {"value": 278.0, "min_value": 240.652299433, "max_value": 333.514367234, "start_time": "2022-06-13T00:00:00", "end_time": "2022-06-14T00:00:00", "metric_id": "ba7f95bfd4d30eaf02aad46a9ef05d93"}, {"value": 297.0, "min_value": 242.632558205, "max_value": 333.059749487, "start_time": "2022-06-14T00:00:00", "end_time": "2022-06-15T00:00:00", "metric_id": "f29377c3087f30be17c05b396e27d158"}, {"value": 50.0, "min_value": 242.632558205, "max_value": 333.059749487, "start_time": "2022-06-15T00:00:00", "end_time": "2022-06-16T00:00:00", "metric_id": "a824b15bbde4d0c0a6ca18ceb8459303"}], "result_description": "The last row_count value is 50. The average for this metric is 270.857."}}, {"test_unique_id": "test.jaffle_shop_online.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "stg_orders", "column_name": "status", "test_name": "accepted_values", "test_display_name": "Accepted Values", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "warn", "model_unique_id": "model.jaffle_shop_online.stg_orders", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_orders", "test_type": "dbt_test", "test_sub_type": "accepted_values", "test_query": "with all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from elementary_tests.jaffle_shop_online.stg_orders\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'placed','shipped','completed','return_pending','returned'\n)", "test_params": "{\"values\": [\"placed\", \"shipped\", \"completed\", \"return_pending\", \"returned\"], \"column_name\": \"status\", \"model\": \"{{ get_where_subquery(ref('stg_orders')) }}\"}", "test_results": {"display_name": "Accepted Values - failed results sample", "results_sample": [{"value_field": "lost", "n_records": 26.0}], "error_message": "Got 1 result, configured to warn if != 0", "failed_rows_count": 1}}], "model.jaffle_shop_online.stg_payments": [{"test_unique_id": "test.jaffle_shop_online.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "stg_payments", "column_name": "payment_method", "test_name": "accepted_values", "test_display_name": "Accepted Values", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_payments", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_payments", "test_type": "dbt_test", "test_sub_type": "accepted_values", "test_query": "with all_values as (\n\n    select\n        payment_method as value_field,\n        count(*) as n_records\n\n    from elementary_tests.jaffle_shop_online.stg_payments\n    group by payment_method\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'credit_card','coupon','bank_transfer','gift_card'\n)", "test_params": "{\"values\": [\"credit_card\", \"coupon\", \"bank_transfer\", \"gift_card\"], \"column_name\": \"payment_method\", \"model\": \"{{ get_where_subquery(ref('stg_payments')) }}\"}", "test_results": {"display_name": "Accepted Values - failed results sample", "results_sample": "", "error_message": "No error message", "failed_rows_count": -1}}, {"test_unique_id": "test.jaffle_shop_online.unique_stg_payments_payment_id.3744510712", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "stg_payments", "column_name": "payment_id", "test_name": "unique", "test_display_name": "Unique", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_payments", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_payments", "test_type": "dbt_test", "test_sub_type": "unique", "test_query": "select\n    payment_id as unique_field,\n    count(*) as n_records\n\nfrom elementary_tests.jaffle_shop_online.stg_payments\nwhere payment_id is not null\ngroup by payment_id\nhaving count(*) > 1", "test_params": "{\"column_name\": \"payment_id\", \"model\": \"{{ get_where_subquery(ref('stg_payments')) }}\"}", "test_results": {"display_name": "Unique - failed results sample", "results_sample": "", "error_message": "No error message", "failed_rows_count": -1}}, {"test_unique_id": "test.jaffle_shop_online.not_null_stg_payments_payment_id.c19cc50075", "database_name": "elementary_tests", "schema_name": "jaffle_shop_online", "table_name": "stg_payments", "column_name": "payment_id", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2022-06-16 23:32:53", "latest_run_time_utc": "2022-06-16 20:32:53", "latest_run_status": "pass", "model_unique_id": "model.jaffle_shop_online.stg_payments", "table_unique_id": "elementary_tests.jaffle_shop_online.stg_payments", "test_type": "dbt_test", "test_sub_type": "not_null", "test_query": "select payment_id\nfrom elementary_tests.jaffle_shop_online.stg_payments\nwhere payment_id is null", "test_params": "{\"column_name\": \"payment_id\", \"model\": \"{{ get_where_subquery(ref('stg_payments')) }}\"}", "test_results": {"display_name": "Not Null - failed results sample", "results_sample": "", "error_message": "No error message", "failed_rows_count": -1}}]}, "totals": {"model.jaffle_shop_online.stg_signups": {"1d": {"errors": 1, "warnings": 0, "resolved": 0, "passed": 37}, "7d": {"errors": 1, "warnings": 0, "resolved": 0, "passed": 37}, "30d": {"errors": 1, "warnings": 0, "resolved": 0, "passed": 37}}, "model.jaffle_shop_online.customers": {"1d": {"errors": 2, "warnings": 0, "resolved": 0, "passed": 57}, "7d": {"errors": 2, "warnings": 0, "resolved": 0, "passed": 57}, "30d": {"errors": 2, "warnings": 0, "resolved": 0, "passed": 57}}, "model.jaffle_shop_online.orders": {"1d": {"errors": 3, "warnings": 1, "resolved": 0, "passed": 9}, "7d": {"errors": 3, "warnings": 1, "resolved": 0, "passed": 9}, "30d": {"errors": 3, "warnings": 1, "resolved": 0, "passed": 9}}, "model.jaffle_shop_online.stg_customers": {"1d": {"errors": 1, "warnings": 0, "resolved": 0, "passed": 2}, "7d": {"errors": 1, "warnings": 0, "resolved": 0, "passed": 2}, "30d": {"errors": 1, "warnings": 0, "resolved": 0, "passed": 2}}, "model.jaffle_shop_online.stg_orders": {"1d": {"errors": 1, "warnings": 1, "resolved": 0, "passed": 2}, "7d": {"errors": 1, "warnings": 1, "resolved": 0, "passed": 2}, "30d": {"errors": 1, "warnings": 1, "resolved": 0, "passed": 2}}, "model.jaffle_shop_online.stg_payments": {"1d": {"errors": 0, "warnings": 0, "resolved": 0, "passed": 3}, "7d": {"errors": 0, "warnings": 0, "resolved": 0, "passed": 3}, "30d": {"errors": 0, "warnings": 0, "resolved": 0, "passed": 3}}}}